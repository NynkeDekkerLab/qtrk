\hypertarget{class_q_i}{}\section{QI Class Reference}
\label{class_q_i}\index{QI@{QI}}


{\ttfamily \#include $<$Q\+I.\+h$>$}

\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{struct_q_i_1_1_device_instance}{Device\+Instance}
\item 
struct \hyperlink{struct_q_i_1_1_stream_instance}{Stream\+Instance}
\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$typename T\+Image\+Sampler $>$ }\\void \hyperlink{class_q_i_a084274d952e1430627110818f398a3d4}{Execute} (\hyperlink{struct_base_kernel_params}{Base\+Kernel\+Params} \&p, const \hyperlink{struct_q_trk_computed_config}{Q\+Trk\+Computed\+Config} \&cfg, \hyperlink{struct_q_i_1_1_stream_instance}{Stream\+Instance} $\ast$s, \hyperlink{struct_q_i_1_1_device_instance}{Device\+Instance} $\ast$d, \hyperlink{classdevice__vec}{device\+\_\+vec}$<$ float3 $>$ $\ast$initial, \hyperlink{classdevice__vec}{device\+\_\+vec}$<$ float3 $>$ $\ast$output)
\item 
void \hyperlink{class_q_i_a20a5d23a269c8c5cc1dcce1f5d931e20}{Init\+Device} (\hyperlink{struct_q_i_1_1_device_instance}{Device\+Instance} $\ast$d, \hyperlink{struct_q_trk_computed_config}{Q\+Trk\+Computed\+Config} \&cc)
\item 
void \hyperlink{class_q_i_ae560c53ae31c70ca9a1d6a0a745c75ee}{Init\+Stream} (\hyperlink{struct_q_i_1_1_stream_instance}{Stream\+Instance} $\ast$s, \hyperlink{struct_q_trk_computed_config}{Q\+Trk\+Computed\+Config} \&cc, cuda\+Stream\+\_\+t stream, int \hyperlink{class_q_i_aa7bd10a94c9128943ff9f1775614f704}{batch\+Size})
\item 
void \hyperlink{class_q_i_a4d2c72e4f110d37299c01da8480671f4}{Init} (\hyperlink{struct_q_trk_computed_config}{Q\+Trk\+Computed\+Config} \&cfg, int \hyperlink{class_q_i_aa7bd10a94c9128943ff9f1775614f704}{batch\+Size})
\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$typename T\+Image\+Sampler $>$ }\\void \hyperlink{class_q_i_a7fef057a722e3c85152f947c7a7dd42a}{Iterate} (\hyperlink{struct_base_kernel_params}{Base\+Kernel\+Params} \&p, \hyperlink{classdevice__vec}{device\+\_\+vec}$<$ float3 $>$ $\ast$initial, \hyperlink{classdevice__vec}{device\+\_\+vec}$<$ float3 $>$ $\ast$output, \hyperlink{struct_q_i_1_1_stream_instance}{Stream\+Instance} $\ast$s, \hyperlink{struct_q_i_1_1_device_instance}{Device\+Instance} $\ast$d, int angular\+Steps)
\item 
dim3 \hyperlink{class_q_i_aae8ddb96f755ee2cc38d9fb36e742dde}{blocks} (int njobs)
\item 
dim3 \hyperlink{class_q_i_aef6a690a8934bcc7ced5332518b04660}{threads} ()
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{struct_q_i_params}{Q\+I\+Params} \hyperlink{class_q_i_af69f420666212bcf5f10a5cf03cd161a}{params}
\item 
int \hyperlink{class_q_i_a9959b6d60486da504fca5c3c86fb2fdd}{qi\+\_\+\+F\+F\+T\+\_\+length}
\item 
int \hyperlink{class_q_i_aa7bd10a94c9128943ff9f1775614f704}{batch\+Size}
\item 
int \hyperlink{class_q_i_afd1c6359668f2de142a18caf2a0e76e0}{num\+Threads}
\end{DoxyCompactItemize}


\subsection{Member Function Documentation}
\index{QI@{QI}!blocks@{blocks}}
\index{blocks@{blocks}!QI@{QI}}
\subsubsection[{\texorpdfstring{blocks(int njobs)}{blocks(int njobs)}}]{\setlength{\rightskip}{0pt plus 5cm}dim3 Q\+I\+::blocks (
\begin{DoxyParamCaption}
\item[{int}]{njobs}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}\hypertarget{class_q_i_aae8ddb96f755ee2cc38d9fb36e742dde}{}\label{class_q_i_aae8ddb96f755ee2cc38d9fb36e742dde}

\begin{DoxyCode}
76 \{ \textcolor{keywordflow}{return} dim3((njobs+\hyperlink{class_q_i_afd1c6359668f2de142a18caf2a0e76e0}{numThreads}-1)/\hyperlink{class_q_i_afd1c6359668f2de142a18caf2a0e76e0}{numThreads}); \}
\end{DoxyCode}
\index{QI@{QI}!Execute@{Execute}}
\index{Execute@{Execute}!QI@{QI}}
\subsubsection[{\texorpdfstring{Execute(\+Base\+Kernel\+Params \&p, const Q\+Trk\+Computed\+Config \&cfg, Stream\+Instance $\ast$s, Device\+Instance $\ast$d, device\+\_\+vec$<$ float3 $>$ $\ast$initial, device\+\_\+vec$<$ float3 $>$ $\ast$output)}{Execute(BaseKernelParams &p, const QTrkComputedConfig &cfg, StreamInstance *s, DeviceInstance *d, device_vec< float3 > *initial, device_vec< float3 > *output)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T\+Image\+Sampler $>$ void Q\+I\+::\+Execute (
\begin{DoxyParamCaption}
\item[{{\bf Base\+Kernel\+Params} \&}]{p, }
\item[{const {\bf Q\+Trk\+Computed\+Config} \&}]{cfg, }
\item[{{\bf Q\+I\+::\+Stream\+Instance} $\ast$}]{s, }
\item[{{\bf Q\+I\+::\+Device\+Instance} $\ast$}]{d, }
\item[{{\bf device\+\_\+vec}$<$ float3 $>$ $\ast$}]{initial, }
\item[{{\bf device\+\_\+vec}$<$ float3 $>$ $\ast$}]{output}
\end{DoxyParamCaption}
)}\hypertarget{class_q_i_a084274d952e1430627110818f398a3d4}{}\label{class_q_i_a084274d952e1430627110818f398a3d4}

\begin{DoxyCode}
268 \{
269     \textcolor{keywordtype}{float} angsteps = cfg.\hyperlink{struct_q_trk_computed_config_a1ba87257b24e5b7e427aa92dd4114792}{qi\_angstepspq} / powf(cfg.\hyperlink{struct_q_trk_settings_aceebf67ba9ecc215d49c6b2739afae3d}{qi\_angstep\_factor}, cfg.
      \hyperlink{struct_q_trk_settings_a12105babb328a9a7ec90f0eab074fabb}{qi\_iterations});
270 
271     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} a=0;a<cfg.\hyperlink{struct_q_trk_settings_a12105babb328a9a7ec90f0eab074fabb}{qi\_iterations};a++) \{
272         \hyperlink{classdevice__vec}{device\_vec<float3>}* dst = a==0 ? initial : output;
273         Iterate< TImageSampler > (p, dst, output, s, d, std::max(
      \hyperlink{_queued_tracker_8h_a1625167c310599739f4d73170413e64a}{MIN\_RADPROFILE\_SMP\_COUNT}, (\textcolor{keywordtype}{int})angsteps) );
274         angsteps *= cfg.\hyperlink{struct_q_trk_settings_aceebf67ba9ecc215d49c6b2739afae3d}{qi\_angstep\_factor};
275     \}
276 \}
\end{DoxyCode}
\index{QI@{QI}!Init@{Init}}
\index{Init@{Init}!QI@{QI}}
\subsubsection[{\texorpdfstring{Init(\+Q\+Trk\+Computed\+Config \&cfg, int batch\+Size)}{Init(QTrkComputedConfig &cfg, int batchSize)}}]{\setlength{\rightskip}{0pt plus 5cm}void Q\+I\+::\+Init (
\begin{DoxyParamCaption}
\item[{{\bf Q\+Trk\+Computed\+Config} \&}]{cfg, }
\item[{int}]{batch\+Size}
\end{DoxyParamCaption}
)}\hypertarget{class_q_i_a4d2c72e4f110d37299c01da8480671f4}{}\label{class_q_i_a4d2c72e4f110d37299c01da8480671f4}

\begin{DoxyCode}
385 \{
386     \hyperlink{struct_q_i_params}{QIParams}& qi = \hyperlink{class_q_i_af69f420666212bcf5f10a5cf03cd161a}{params};
387     qi.\hyperlink{struct_q_i_params_a2078879365690b162cac67e45837a29d}{trigtablesize} = cfg.\hyperlink{struct_q_trk_computed_config_a1ba87257b24e5b7e427aa92dd4114792}{qi\_angstepspq};
388     qi.\hyperlink{struct_q_i_params_a233d13629ccc9d8c2c500286b13eeb97}{iterations} = cfg.\hyperlink{struct_q_trk_settings_a12105babb328a9a7ec90f0eab074fabb}{qi\_iterations};
389     qi.\hyperlink{struct_q_i_params_a59a4abd887cfec3392bb5ecd6891d7d6}{maxRadius} = cfg.\hyperlink{struct_q_trk_computed_config_a9784dbeb638bde1f3204f9ca5af720c6}{qi\_maxradius};
390     qi.\hyperlink{struct_q_i_params_a4c3b954348ae3ee381eab69122983515}{minRadius} = cfg.\hyperlink{struct_q_trk_settings_a7b5f3e61b4dcab6330c56e7bcd96e82d}{qi\_minradius};
391     qi.\hyperlink{struct_q_i_params_a19b7d550113364de4e4f11e2c9cfea0e}{radialSteps} = cfg.\hyperlink{struct_q_trk_computed_config_ab1a11e7a567a3267c57f77626c6c9c93}{qi\_radialsteps};
392 
393     cudaDeviceProp prop;
394     cudaGetDeviceProperties(&prop, 0);
395     \hyperlink{class_q_i_afd1c6359668f2de142a18caf2a0e76e0}{numThreads} = prop.warpSize;
396 
397     this->\hyperlink{class_q_i_aa7bd10a94c9128943ff9f1775614f704}{batchSize} = \hyperlink{class_q_i_aa7bd10a94c9128943ff9f1775614f704}{batchSize};
398 \}\end{DoxyCode}
\index{QI@{QI}!Init\+Device@{Init\+Device}}
\index{Init\+Device@{Init\+Device}!QI@{QI}}
\subsubsection[{\texorpdfstring{Init\+Device(\+Device\+Instance $\ast$d, Q\+Trk\+Computed\+Config \&cc)}{InitDevice(DeviceInstance *d, QTrkComputedConfig &cc)}}]{\setlength{\rightskip}{0pt plus 5cm}void Q\+I\+::\+Init\+Device (
\begin{DoxyParamCaption}
\item[{{\bf Device\+Instance} $\ast$}]{d, }
\item[{{\bf Q\+Trk\+Computed\+Config} \&}]{cc}
\end{DoxyParamCaption}
)}\hypertarget{class_q_i_a20a5d23a269c8c5cc1dcce1f5d931e20}{}\label{class_q_i_a20a5d23a269c8c5cc1dcce1f5d931e20}

\begin{DoxyCode}
342 \{
343     std::vector<float2> qi\_radialgrid(cc.\hyperlink{struct_q_trk_computed_config_a1ba87257b24e5b7e427aa92dd4114792}{qi\_angstepspq});
344     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<cc.\hyperlink{struct_q_trk_computed_config_a1ba87257b24e5b7e427aa92dd4114792}{qi\_angstepspq};i++)  \{
345         \textcolor{keywordtype}{float} ang = 0.5f*3.141593f*(i+0.5f)/(\textcolor{keywordtype}{float})cc.\hyperlink{struct_q_trk_computed_config_a1ba87257b24e5b7e427aa92dd4114792}{qi\_angstepspq};
346         qi\_radialgrid[i]=make\_float2(cos(ang), sin(ang));
347     \}
348     d->qi\_trigtable = qi\_radialgrid;
349 
350     std::vector<float> rweights = \hyperlink{utils_8cpp_a8657c1536ca3621943042411f4644e21}{ComputeRadialBinWindow}(cc.
      \hyperlink{struct_q_trk_computed_config_ab1a11e7a567a3267c57f77626c6c9c93}{qi\_radialsteps});
351     d->d\_radialweights = rweights;
352 
353     \hyperlink{struct_q_i_params}{QIParams} dp = \hyperlink{class_q_i_af69f420666212bcf5f10a5cf03cd161a}{params};
354     dp.\hyperlink{struct_q_i_params_a8da3ccdd4b94c119a0d63ff63f28b8e7}{cos\_sin\_table} = d->qi\_trigtable.data;
355 
356     cudaMalloc(&d->d\_qiparams, \textcolor{keyword}{sizeof}(\hyperlink{struct_q_i_params}{QIParams}));
357     cudaMemcpy(d->d\_qiparams, &dp, \textcolor{keyword}{sizeof}(\hyperlink{struct_q_i_params}{QIParams}), cudaMemcpyHostToDevice);
358 \}
\end{DoxyCode}
\index{QI@{QI}!Init\+Stream@{Init\+Stream}}
\index{Init\+Stream@{Init\+Stream}!QI@{QI}}
\subsubsection[{\texorpdfstring{Init\+Stream(\+Stream\+Instance $\ast$s, Q\+Trk\+Computed\+Config \&cc, cuda\+Stream\+\_\+t stream, int batch\+Size)}{InitStream(StreamInstance *s, QTrkComputedConfig &cc, cudaStream_t stream, int batchSize)}}]{\setlength{\rightskip}{0pt plus 5cm}void Q\+I\+::\+Init\+Stream (
\begin{DoxyParamCaption}
\item[{{\bf Stream\+Instance} $\ast$}]{s, }
\item[{{\bf Q\+Trk\+Computed\+Config} \&}]{cc, }
\item[{cuda\+Stream\+\_\+t}]{stream, }
\item[{int}]{batch\+Size}
\end{DoxyParamCaption}
)}\hypertarget{class_q_i_ae560c53ae31c70ca9a1d6a0a745c75ee}{}\label{class_q_i_ae560c53ae31c70ca9a1d6a0a745c75ee}

\begin{DoxyCode}
361 \{
362     \textcolor{keywordtype}{int} fftlen = cc.\hyperlink{struct_q_trk_computed_config_ab1a11e7a567a3267c57f77626c6c9c93}{qi\_radialsteps}*2;
363     s->stream = stream;
364     s->d\_quadrants.init(fftlen*\hyperlink{class_q_i_aa7bd10a94c9128943ff9f1775614f704}{batchSize}*2);
365     s->d\_QIprofiles.init(batchSize*2*fftlen); \textcolor{comment}{// (2 axis) * (2 radialsteps) = 8 * nr = 2 * fftlen}
366     s->d\_QIprofiles\_reverse.init(batchSize*2*fftlen);
367     s->d\_shiftbuffer.init(fftlen * batchSize);
368 
369     \textcolor{comment}{// 2* batchSize, since X & Y both need an FFT transform}
370     \textcolor{comment}{// cufftPlanMany and 1d with batch argument are equivalent in memory usage and speed}
371     \textcolor{comment}{// Using Many because the batch argument for 1d is strictly speaking deprecated (see cufft.h)}
372     cufftResult\_t r = cufftPlanMany(&s->fftPlan, 1, &fftlen, 0, 1, fftlen, 0, 1, fftlen, CUFFT\_C2C, 
      batchSize*2);
373     \textcolor{comment}{//cufftResult\_t r = cufftPlan1d(&s->fftPlan, fftlen, CUFFT\_C2C, batchSize*2);}
374 
375     \textcolor{keywordflow}{if}(r != CUFFT\_SUCCESS) \{
376         \textcolor{keywordflow}{throw} std::runtime\_error( \hyperlink{utils_8cpp_aba26a6b64035ef7962a63b760dd9013e}{SPrintf}(\textcolor{stringliteral}{"CUFFT plan creation failed. FFT len: %d. Batchsize: %d\(\backslash\)n"}
      , fftlen, batchSize*2));
377     \}
378     \hyperlink{gpu__utils_8h_ae6b059a7637782d61577e695c9d6303e}{CheckCUDAError}(cufftSetCompatibilityMode(s->fftPlan, CUFFT\_COMPATIBILITY\_NATIVE));
379     \hyperlink{gpu__utils_8h_ae6b059a7637782d61577e695c9d6303e}{CheckCUDAError}(cufftSetStream(s->fftPlan, stream));
380 
381     this->\hyperlink{class_q_i_a9959b6d60486da504fca5c3c86fb2fdd}{qi\_FFT\_length} = fftlen;
382 \}
\end{DoxyCode}
\index{QI@{QI}!Iterate@{Iterate}}
\index{Iterate@{Iterate}!QI@{QI}}
\subsubsection[{\texorpdfstring{Iterate(\+Base\+Kernel\+Params \&p, device\+\_\+vec$<$ float3 $>$ $\ast$initial, device\+\_\+vec$<$ float3 $>$ $\ast$output, Stream\+Instance $\ast$s, Device\+Instance $\ast$d, int angular\+Steps)}{Iterate(BaseKernelParams &p, device_vec< float3 > *initial, device_vec< float3 > *output, StreamInstance *s, DeviceInstance *d, int angularSteps)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T\+Image\+Sampler $>$ void Q\+I\+::\+Iterate (
\begin{DoxyParamCaption}
\item[{{\bf Base\+Kernel\+Params} \&}]{p, }
\item[{{\bf device\+\_\+vec}$<$ float3 $>$ $\ast$}]{initial, }
\item[{{\bf device\+\_\+vec}$<$ float3 $>$ $\ast$}]{output, }
\item[{{\bf Stream\+Instance} $\ast$}]{s, }
\item[{{\bf Device\+Instance} $\ast$}]{d, }
\item[{int}]{angular\+Steps}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{class_q_i_a7fef057a722e3c85152f947c7a7dd42a}{}\label{class_q_i_a7fef057a722e3c85152f947c7a7dd42a}

\begin{DoxyCode}
280 \{
281     \textcolor{keywordflow}{if} (1) \{
282         \textcolor{comment}{// This part makes better use of parallelism (computing every quadrant's radial bin in a seperate
       thread)           }
283         dim3 qdrThreads(16, 8, 4);
284         dim3 qdrDim( (p.\hyperlink{struct_base_kernel_params_aec40d44810d0e0a6640c66038af1fbf2}{njobs} + qdrThreads.x - 1) / qdrThreads.x, (\hyperlink{class_q_i_af69f420666212bcf5f10a5cf03cd161a}{params}.
      \hyperlink{struct_q_i_params_a19b7d550113364de4e4f11e2c9cfea0e}{radialSteps} + qdrThreads.y - 1) / qdrThreads.y);
285 
286         QI\_ComputeQuadrants<TImageSampler> <<< qdrDim , qdrThreads, 0, s->stream >>> 
287             (p, initial->\hyperlink{classdevice__vec_a908e53910a02968513832c242790caa0}{data}, s->d\_quadrants.data, d->d\_qiparams, angularSteps);
288         
289         \hyperlink{group__kernels_ga0a68cdd1dd0c10476711ae6d4316fb40}{QI\_QuadrantsToProfiles} <<< \hyperlink{class_q_i_aae8ddb96f755ee2cc38d9fb36e742dde}{blocks}(p.\hyperlink{struct_base_kernel_params_aec40d44810d0e0a6640c66038af1fbf2}{njobs}), 
      \hyperlink{class_q_i_aef6a690a8934bcc7ced5332518b04660}{threads}(), 0, s->stream >>> 
290             (p, s->d\_quadrants.data, s->d\_QIprofiles.data, s->d\_QIprofiles\_reverse.data, d->d\_radialweights
      .data, d->d\_qiparams);
291         \textcolor{comment}{// DbgOutputVectorToFile("D:\(\backslash\)\(\backslash\)TestImages\(\backslash\)\(\backslash\)gpu\_qi\_prof\_new.csv", s->d\_quadrants, true);}
292     \} \textcolor{keywordflow}{else} \{
293         \hyperlink{struct_q_i_params}{QIParams} dp = \hyperlink{class_q_i_af69f420666212bcf5f10a5cf03cd161a}{params};
294         dp.\hyperlink{struct_q_i_params_a8da3ccdd4b94c119a0d63ff63f28b8e7}{cos\_sin\_table} = d->qi\_trigtable.data;
295 
296         QI\_ComputeProfile <TImageSampler> <<< \hyperlink{class_q_i_aae8ddb96f755ee2cc38d9fb36e742dde}{blocks}(p.\hyperlink{struct_base_kernel_params_aec40d44810d0e0a6640c66038af1fbf2}{njobs}), 
      \hyperlink{class_q_i_aef6a690a8934bcc7ced5332518b04660}{threads}(), 0, s->stream >>> (p, initial->\hyperlink{classdevice__vec_a908e53910a02968513832c242790caa0}{data}, 
297             s->d\_quadrants.data, s->d\_QIprofiles.data, s->d\_QIprofiles\_reverse.data, dp, d->d\_radialweights
      .data, angularSteps);
298         \textcolor{comment}{// DbgOutputVectorToFile("D:\(\backslash\)\(\backslash\)TestImages\(\backslash\)\(\backslash\)gpu\_qi\_prof\_old.csv", s->d\_quadrants, true);}
299     \}
300 
301 \textcolor{preprocessor}{#ifdef QI\_DEBUG}
302     \hyperlink{gpu__utils_8h_a90bb5228a452340dd6a505cfb4db25c7}{DbgCopyResult}(s->d\_QIprofiles, \hyperlink{test_8cu_a0f78dfbff0fc38f749d5a83cf7293b89}{cmp\_gpu\_qi\_prof});
303 \textcolor{preprocessor}{#endif}
304 
305     cufftComplex* prof = (cufftComplex*)s->d\_QIprofiles.data;
306     cufftComplex* revprof = (cufftComplex*)s->d\_QIprofiles\_reverse.data;
307     \hyperlink{gpu__utils_8h_ae6b059a7637782d61577e695c9d6303e}{CheckCUDAError}(cufftExecC2C(s->fftPlan, prof, prof, CUFFT\_FORWARD));
308     \hyperlink{gpu__utils_8h_ae6b059a7637782d61577e695c9d6303e}{CheckCUDAError}(cufftExecC2C(s->fftPlan, revprof, revprof, CUFFT\_FORWARD));
309 
310     \textcolor{keywordtype}{int} nval = \hyperlink{class_q_i_a9959b6d60486da504fca5c3c86fb2fdd}{qi\_FFT\_length} * 2 * \hyperlink{class_q_i_aa7bd10a94c9128943ff9f1775614f704}{batchSize};
311     \textcolor{keywordtype}{int} nthread = 256;
312     \hyperlink{group__kernels_gaf620f6888bd27603c02cbbcc6cb77cce}{QI\_MultiplyWithConjugate}<<< dim3( (nval + nthread - 1)/nthread ), dim3(nthread)
      , 0, s->stream >>>(nval, prof, revprof);
313     \textcolor{comment}{/* }
314 \textcolor{comment}{    Experiment to see the effect of different block sizes.}
315 \textcolor{comment}{    Seems that if the whole parameter space is covered, block sizes don't matter for execution speed.}
316 \textcolor{comment}{}
317 \textcolor{comment}{    dim3 threadsDim = dim3(16, 16);}
318 \textcolor{comment}{    int numBlocks = nval / (threadsDim.x * threadsDim.y);}
319 \textcolor{comment}{    dim3 blocksDim = dim3( sqrt((double)numBlocks)+1, sqrt((double)numBlocks)+1 );}
320 \textcolor{comment}{        }
321 \textcolor{comment}{    if(nval > threadsDim.x * threadsDim.y * blocksDim.x * blocksDim.y)\{}
322 \textcolor{comment}{        printf("\(\backslash\)nNot whole space covered: nval > total threads\(\backslash\)n");}
323 \textcolor{comment}{        printf("nval: %d, nthread: %d, block (%d,%d), threads (%d,%d)\(\backslash\)n", nval, nthread, blocksDim.x,
       blocksDim.y, threadsDim.x, threadsDim.y);}
324 \textcolor{comment}{    \}}
325 \textcolor{comment}{    QI\_MultiplyWithConjugate<<< blocksDim, threadsDim, 0, s->stream >>> (nval, prof, revprof);}
326 \textcolor{comment}{    */}
327     
328     \hyperlink{gpu__utils_8h_ae6b059a7637782d61577e695c9d6303e}{CheckCUDAError}(cufftExecC2C(s->fftPlan, prof, prof, CUFFT\_INVERSE));
329 
330 \textcolor{preprocessor}{#ifdef QI\_DEBUG}
331     \hyperlink{gpu__utils_8h_a90bb5228a452340dd6a505cfb4db25c7}{DbgCopyResult}(s->d\_QIprofiles, \hyperlink{test_8cu_a968a1f45bfd391f01eaee72d1ba61237}{cmp\_gpu\_qi\_fft\_out});
332 \textcolor{preprocessor}{#endif}
333 
334     float2* d\_offsets=0;
335     \textcolor{keywordtype}{float} pixelsPerProfLen = (\hyperlink{class_q_i_af69f420666212bcf5f10a5cf03cd161a}{params}.\hyperlink{struct_q_i_params_a59a4abd887cfec3392bb5ecd6891d7d6}{maxRadius}-\hyperlink{class_q_i_af69f420666212bcf5f10a5cf03cd161a}{params}.
      \hyperlink{struct_q_i_params_a4c3b954348ae3ee381eab69122983515}{minRadius})/\hyperlink{class_q_i_af69f420666212bcf5f10a5cf03cd161a}{params}.\hyperlink{struct_q_i_params_a19b7d550113364de4e4f11e2c9cfea0e}{radialSteps};
336     dim3 nBlocks=\hyperlink{class_q_i_aae8ddb96f755ee2cc38d9fb36e742dde}{blocks}(p.\hyperlink{struct_base_kernel_params_aec40d44810d0e0a6640c66038af1fbf2}{njobs}), nThreads=\hyperlink{class_q_i_aef6a690a8934bcc7ced5332518b04660}{threads}();
337     \hyperlink{group__kernels_ga095edb116bff714a009b7cf60b52cb3b}{QI\_OffsetPositions}<<<nBlocks, nThreads, 0, s->stream>>>
338         (p.\hyperlink{struct_base_kernel_params_aec40d44810d0e0a6640c66038af1fbf2}{njobs}, initial->\hyperlink{classdevice__vec_a908e53910a02968513832c242790caa0}{data}, newpos->data, prof, \hyperlink{class_q_i_a9959b6d60486da504fca5c3c86fb2fdd}{qi\_FFT\_length}, d\_offsets, 
      pixelsPerProfLen, s->d\_shiftbuffer.data); 
339 \}
\end{DoxyCode}
\index{QI@{QI}!threads@{threads}}
\index{threads@{threads}!QI@{QI}}
\subsubsection[{\texorpdfstring{threads()}{threads()}}]{\setlength{\rightskip}{0pt plus 5cm}dim3 Q\+I\+::threads (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}\hypertarget{class_q_i_aef6a690a8934bcc7ced5332518b04660}{}\label{class_q_i_aef6a690a8934bcc7ced5332518b04660}

\begin{DoxyCode}
77 \{ \textcolor{keywordflow}{return} dim3(\hyperlink{class_q_i_afd1c6359668f2de142a18caf2a0e76e0}{numThreads}); \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\index{QI@{QI}!batch\+Size@{batch\+Size}}
\index{batch\+Size@{batch\+Size}!QI@{QI}}
\subsubsection[{\texorpdfstring{batch\+Size}{batchSize}}]{\setlength{\rightskip}{0pt plus 5cm}int Q\+I\+::batch\+Size\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{class_q_i_aa7bd10a94c9128943ff9f1775614f704}{}\label{class_q_i_aa7bd10a94c9128943ff9f1775614f704}
\index{QI@{QI}!num\+Threads@{num\+Threads}}
\index{num\+Threads@{num\+Threads}!QI@{QI}}
\subsubsection[{\texorpdfstring{num\+Threads}{numThreads}}]{\setlength{\rightskip}{0pt plus 5cm}int Q\+I\+::num\+Threads\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{class_q_i_afd1c6359668f2de142a18caf2a0e76e0}{}\label{class_q_i_afd1c6359668f2de142a18caf2a0e76e0}
\index{QI@{QI}!params@{params}}
\index{params@{params}!QI@{QI}}
\subsubsection[{\texorpdfstring{params}{params}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Q\+I\+Params} Q\+I\+::params\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{class_q_i_af69f420666212bcf5f10a5cf03cd161a}{}\label{class_q_i_af69f420666212bcf5f10a5cf03cd161a}
\index{QI@{QI}!qi\+\_\+\+F\+F\+T\+\_\+length@{qi\+\_\+\+F\+F\+T\+\_\+length}}
\index{qi\+\_\+\+F\+F\+T\+\_\+length@{qi\+\_\+\+F\+F\+T\+\_\+length}!QI@{QI}}
\subsubsection[{\texorpdfstring{qi\+\_\+\+F\+F\+T\+\_\+length}{qi_FFT_length}}]{\setlength{\rightskip}{0pt plus 5cm}int Q\+I\+::qi\+\_\+\+F\+F\+T\+\_\+length\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{class_q_i_a9959b6d60486da504fca5c3c86fb2fdd}{}\label{class_q_i_a9959b6d60486da504fca5c3c86fb2fdd}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
cudatrack/\hyperlink{_q_i_8h}{Q\+I.\+h}\item 
cudatrack/\hyperlink{_q_i__impl_8h}{Q\+I\+\_\+impl.\+h}\end{DoxyCompactItemize}
