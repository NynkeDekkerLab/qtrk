\hypertarget{gpu__utils_8h}{}\section{cudatrack/gpu\+\_\+utils.h File Reference}
\label{gpu__utils_8h}\index{cudatrack/gpu\+\_\+utils.\+h@{cudatrack/gpu\+\_\+utils.\+h}}
{\ttfamily \#include $<$cuda\+\_\+runtime.\+h$>$}\\*
{\ttfamily \#include $<$vector$>$}\\*
{\ttfamily \#include $<$cstdarg$>$}\\*
{\ttfamily \#include \char`\"{}cufft.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}Lsq\+Quadratic\+Fit.\+h\char`\"{}}\\*
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classdevice__vec}{device\+\_\+vec$<$ T $>$}
\item 
struct \hyperlink{struct_measure_time}{Measure\+Time}
\item 
class \hyperlink{classpinned__array}{pinned\+\_\+array$<$ T, flags $>$}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{gpu__utils_8h_a69f41cb6c15f0e34b0889a5f6d5aae32}{C\+U\+D\+A\+\_\+\+S\+U\+P\+P\+O\+R\+T\+E\+D\+\_\+\+F\+U\+NC}~\+\_\+\+\_\+device\+\_\+\+\_\+ \+\_\+\+\_\+host\+\_\+\+\_\+
\item 
\#define \hyperlink{gpu__utils_8h_ac50b87a58396e77c6168aa6f3be3c189}{C\+U\+B\+O\+TH}~\+\_\+\+\_\+device\+\_\+\+\_\+ \+\_\+\+\_\+host\+\_\+\+\_\+
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{gpu__utils_8h_a62bdd2284842cb0edc350adef80e0d85}{output\+Total\+G\+P\+U\+Mem\+Use} (std\+::string info=\char`\"{}\char`\"{})
\item 
void \hyperlink{gpu__utils_8h_ae6b059a7637782d61577e695c9d6303e}{Check\+C\+U\+D\+A\+Error} (cufft\+Result\+\_\+t err)
\item 
void \hyperlink{gpu__utils_8h_ac81ed8a6b8dd4ee9303e694b4a4a2421}{Check\+C\+U\+D\+A\+Error} (cuda\+Error\+\_\+t err)
\item 
void \hyperlink{gpu__utils_8h_a2a2375f575eb720f0d58566b25d743a9}{Check\+C\+U\+D\+A\+Error} ()
\item 
void \hyperlink{gpu__utils_8h_a0e8c0c69887658f653eefbb80334bc3f}{dbg\+C\+U\+D\+A\+Error\+Check} (cuda\+Error\+\_\+t e)
\item 
void \hyperlink{gpu__utils_8h_a90bb5228a452340dd6a505cfb4db25c7}{Dbg\+Copy\+Result} (\hyperlink{classdevice__vec}{device\+\_\+vec}$<$ float2 $>$ src, std\+::vector$<$ std\+::complex$<$ float $>$ $>$ \&dst)
\item 
void \hyperlink{gpu__utils_8h_a73827a1df19f4e7128cd0818e2e8d80d}{Dbg\+Copy\+Result} (\hyperlink{classdevice__vec}{device\+\_\+vec}$<$ float $>$ src, std\+::vector$<$ float $>$ \&dst)
\item 
void \hyperlink{gpu__utils_8h_a0daa7f743247f9563aef777dbcc7e5f2}{Dbg\+Output\+Vector\+To\+File} (std\+::string loc, \hyperlink{classdevice__vec}{device\+\_\+vec}$<$ float $>$ \&src, bool append)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\index{gpu\+\_\+utils.\+h@{gpu\+\_\+utils.\+h}!C\+U\+B\+O\+TH@{C\+U\+B\+O\+TH}}
\index{C\+U\+B\+O\+TH@{C\+U\+B\+O\+TH}!gpu\+\_\+utils.\+h@{gpu\+\_\+utils.\+h}}
\subsubsection[{\texorpdfstring{C\+U\+B\+O\+TH}{CUBOTH}}]{\setlength{\rightskip}{0pt plus 5cm}\#define C\+U\+B\+O\+TH~\+\_\+\+\_\+device\+\_\+\+\_\+ \+\_\+\+\_\+host\+\_\+\+\_\+}\hypertarget{gpu__utils_8h_ac50b87a58396e77c6168aa6f3be3c189}{}\label{gpu__utils_8h_ac50b87a58396e77c6168aa6f3be3c189}
\index{gpu\+\_\+utils.\+h@{gpu\+\_\+utils.\+h}!C\+U\+D\+A\+\_\+\+S\+U\+P\+P\+O\+R\+T\+E\+D\+\_\+\+F\+U\+NC@{C\+U\+D\+A\+\_\+\+S\+U\+P\+P\+O\+R\+T\+E\+D\+\_\+\+F\+U\+NC}}
\index{C\+U\+D\+A\+\_\+\+S\+U\+P\+P\+O\+R\+T\+E\+D\+\_\+\+F\+U\+NC@{C\+U\+D\+A\+\_\+\+S\+U\+P\+P\+O\+R\+T\+E\+D\+\_\+\+F\+U\+NC}!gpu\+\_\+utils.\+h@{gpu\+\_\+utils.\+h}}
\subsubsection[{\texorpdfstring{C\+U\+D\+A\+\_\+\+S\+U\+P\+P\+O\+R\+T\+E\+D\+\_\+\+F\+U\+NC}{CUDA_SUPPORTED_FUNC}}]{\setlength{\rightskip}{0pt plus 5cm}\#define C\+U\+D\+A\+\_\+\+S\+U\+P\+P\+O\+R\+T\+E\+D\+\_\+\+F\+U\+NC~\+\_\+\+\_\+device\+\_\+\+\_\+ \+\_\+\+\_\+host\+\_\+\+\_\+}\hypertarget{gpu__utils_8h_a69f41cb6c15f0e34b0889a5f6d5aae32}{}\label{gpu__utils_8h_a69f41cb6c15f0e34b0889a5f6d5aae32}


\subsection{Function Documentation}
\index{gpu\+\_\+utils.\+h@{gpu\+\_\+utils.\+h}!Check\+C\+U\+D\+A\+Error@{Check\+C\+U\+D\+A\+Error}}
\index{Check\+C\+U\+D\+A\+Error@{Check\+C\+U\+D\+A\+Error}!gpu\+\_\+utils.\+h@{gpu\+\_\+utils.\+h}}
\subsubsection[{\texorpdfstring{Check\+C\+U\+D\+A\+Error(cufft\+Result\+\_\+t err)}{CheckCUDAError(cufftResult_t err)}}]{\setlength{\rightskip}{0pt plus 5cm}void Check\+C\+U\+D\+A\+Error (
\begin{DoxyParamCaption}
\item[{cufft\+Result\+\_\+t}]{err}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{gpu__utils_8h_ae6b059a7637782d61577e695c9d6303e}{}\label{gpu__utils_8h_ae6b059a7637782d61577e695c9d6303e}

\begin{DoxyCode}
36 \{
37     \textcolor{keywordflow}{if} (err != CUFFT\_SUCCESS) \{
38         \hyperlink{gpu__utils_8h_a62bdd2284842cb0edc350adef80e0d85}{outputTotalGPUMemUse}(\textcolor{stringliteral}{"CUFFT Error"});
39         \textcolor{keywordflow}{throw} std::runtime\_error(\hyperlink{utils_8cpp_aba26a6b64035ef7962a63b760dd9013e}{SPrintf}(\textcolor{stringliteral}{"CUDA error: CUFFT failed (%d)\(\backslash\)n"},err));
40     \}
41 \}
\end{DoxyCode}
\index{gpu\+\_\+utils.\+h@{gpu\+\_\+utils.\+h}!Check\+C\+U\+D\+A\+Error@{Check\+C\+U\+D\+A\+Error}}
\index{Check\+C\+U\+D\+A\+Error@{Check\+C\+U\+D\+A\+Error}!gpu\+\_\+utils.\+h@{gpu\+\_\+utils.\+h}}
\subsubsection[{\texorpdfstring{Check\+C\+U\+D\+A\+Error(cuda\+Error\+\_\+t err)}{CheckCUDAError(cudaError_t err)}}]{\setlength{\rightskip}{0pt plus 5cm}void Check\+C\+U\+D\+A\+Error (
\begin{DoxyParamCaption}
\item[{cuda\+Error\+\_\+t}]{err}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{gpu__utils_8h_ac81ed8a6b8dd4ee9303e694b4a4a2421}{}\label{gpu__utils_8h_ac81ed8a6b8dd4ee9303e694b4a4a2421}

\begin{DoxyCode}
44 \{
45     \textcolor{keywordflow}{if} (err != cudaSuccess) \{
46         \textcolor{keyword}{const} \textcolor{keywordtype}{char}* errstr = cudaGetErrorString(err);
47         \textcolor{keywordflow}{throw} std::runtime\_error(\hyperlink{utils_8cpp_aba26a6b64035ef7962a63b760dd9013e}{SPrintf}(\textcolor{stringliteral}{"CUDA error: %s\(\backslash\)n"} ,errstr).c\_str());
48     \}
49 \}
\end{DoxyCode}
\index{gpu\+\_\+utils.\+h@{gpu\+\_\+utils.\+h}!Check\+C\+U\+D\+A\+Error@{Check\+C\+U\+D\+A\+Error}}
\index{Check\+C\+U\+D\+A\+Error@{Check\+C\+U\+D\+A\+Error}!gpu\+\_\+utils.\+h@{gpu\+\_\+utils.\+h}}
\subsubsection[{\texorpdfstring{Check\+C\+U\+D\+A\+Error()}{CheckCUDAError()}}]{\setlength{\rightskip}{0pt plus 5cm}void Check\+C\+U\+D\+A\+Error (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{gpu__utils_8h_a2a2375f575eb720f0d58566b25d743a9}{}\label{gpu__utils_8h_a2a2375f575eb720f0d58566b25d743a9}

\begin{DoxyCode}
52 \{
53     cudaError\_t err = cudaGetLastError();
54     \textcolor{keywordflow}{if} (err != cudaSuccess) \{
55         \textcolor{keyword}{const} \textcolor{keywordtype}{char}* errstr = cudaGetErrorString(err);
56         \hyperlink{utils_8cpp_a4a7132c90e490d24edecb391a754a9c0}{dbgprintf}(\textcolor{stringliteral}{"CUDA error: %s\(\backslash\)n"} ,errstr);
57     \}
58 \}
\end{DoxyCode}
\index{gpu\+\_\+utils.\+h@{gpu\+\_\+utils.\+h}!Dbg\+Copy\+Result@{Dbg\+Copy\+Result}}
\index{Dbg\+Copy\+Result@{Dbg\+Copy\+Result}!gpu\+\_\+utils.\+h@{gpu\+\_\+utils.\+h}}
\subsubsection[{\texorpdfstring{Dbg\+Copy\+Result(device\+\_\+vec$<$ float2 $>$ src, std\+::vector$<$ std\+::complex$<$ float $>$ $>$ \&dst)}{DbgCopyResult(device_vec< float2 > src, std::vector< std::complex< float > > &dst)}}]{\setlength{\rightskip}{0pt plus 5cm}void Dbg\+Copy\+Result (
\begin{DoxyParamCaption}
\item[{{\bf device\+\_\+vec}$<$ float2 $>$}]{src, }
\item[{std\+::vector$<$ std\+::complex$<$ float $>$ $>$ \&}]{dst}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{gpu__utils_8h_a90bb5228a452340dd6a505cfb4db25c7}{}\label{gpu__utils_8h_a90bb5228a452340dd6a505cfb4db25c7}

\begin{DoxyCode}
266 \{\} 
\end{DoxyCode}
\index{gpu\+\_\+utils.\+h@{gpu\+\_\+utils.\+h}!Dbg\+Copy\+Result@{Dbg\+Copy\+Result}}
\index{Dbg\+Copy\+Result@{Dbg\+Copy\+Result}!gpu\+\_\+utils.\+h@{gpu\+\_\+utils.\+h}}
\subsubsection[{\texorpdfstring{Dbg\+Copy\+Result(device\+\_\+vec$<$ float $>$ src, std\+::vector$<$ float $>$ \&dst)}{DbgCopyResult(device_vec< float > src, std::vector< float > &dst)}}]{\setlength{\rightskip}{0pt plus 5cm}void Dbg\+Copy\+Result (
\begin{DoxyParamCaption}
\item[{{\bf device\+\_\+vec}$<$ float $>$}]{src, }
\item[{std\+::vector$<$ float $>$ \&}]{dst}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{gpu__utils_8h_a73827a1df19f4e7128cd0818e2e8d80d}{}\label{gpu__utils_8h_a73827a1df19f4e7128cd0818e2e8d80d}

\begin{DoxyCode}
267 \{\}
\end{DoxyCode}
\index{gpu\+\_\+utils.\+h@{gpu\+\_\+utils.\+h}!dbg\+C\+U\+D\+A\+Error\+Check@{dbg\+C\+U\+D\+A\+Error\+Check}}
\index{dbg\+C\+U\+D\+A\+Error\+Check@{dbg\+C\+U\+D\+A\+Error\+Check}!gpu\+\_\+utils.\+h@{gpu\+\_\+utils.\+h}}
\subsubsection[{\texorpdfstring{dbg\+C\+U\+D\+A\+Error\+Check(cuda\+Error\+\_\+t e)}{dbgCUDAErrorCheck(cudaError_t e)}}]{\setlength{\rightskip}{0pt plus 5cm}void dbg\+C\+U\+D\+A\+Error\+Check (
\begin{DoxyParamCaption}
\item[{cuda\+Error\+\_\+t}]{e}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{gpu__utils_8h_a0e8c0c69887658f653eefbb80334bc3f}{}\label{gpu__utils_8h_a0e8c0c69887658f653eefbb80334bc3f}

\begin{DoxyCode}
62 \{\}
\end{DoxyCode}
\index{gpu\+\_\+utils.\+h@{gpu\+\_\+utils.\+h}!Dbg\+Output\+Vector\+To\+File@{Dbg\+Output\+Vector\+To\+File}}
\index{Dbg\+Output\+Vector\+To\+File@{Dbg\+Output\+Vector\+To\+File}!gpu\+\_\+utils.\+h@{gpu\+\_\+utils.\+h}}
\subsubsection[{\texorpdfstring{Dbg\+Output\+Vector\+To\+File(std\+::string loc, device\+\_\+vec$<$ float $>$ \&src, bool append)}{DbgOutputVectorToFile(std::string loc, device_vec< float > &src, bool append)}}]{\setlength{\rightskip}{0pt plus 5cm}void Dbg\+Output\+Vector\+To\+File (
\begin{DoxyParamCaption}
\item[{std\+::string}]{loc, }
\item[{{\bf device\+\_\+vec}$<$ float $>$ \&}]{src, }
\item[{bool}]{append}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{gpu__utils_8h_a0daa7f743247f9563aef777dbcc7e5f2}{}\label{gpu__utils_8h_a0daa7f743247f9563aef777dbcc7e5f2}

\begin{DoxyCode}
268 \{\}
\end{DoxyCode}
\index{gpu\+\_\+utils.\+h@{gpu\+\_\+utils.\+h}!output\+Total\+G\+P\+U\+Mem\+Use@{output\+Total\+G\+P\+U\+Mem\+Use}}
\index{output\+Total\+G\+P\+U\+Mem\+Use@{output\+Total\+G\+P\+U\+Mem\+Use}!gpu\+\_\+utils.\+h@{gpu\+\_\+utils.\+h}}
\subsubsection[{\texorpdfstring{output\+Total\+G\+P\+U\+Mem\+Use(std\+::string info="""")}{outputTotalGPUMemUse(std::string info="")}}]{\setlength{\rightskip}{0pt plus 5cm}void output\+Total\+G\+P\+U\+Mem\+Use (
\begin{DoxyParamCaption}
\item[{std\+::string}]{info = {\ttfamily \char`\"{}\char`\"{}}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{gpu__utils_8h_a62bdd2284842cb0edc350adef80e0d85}{}\label{gpu__utils_8h_a62bdd2284842cb0edc350adef80e0d85}

\begin{DoxyCode}
18 \{
19     \textcolor{comment}{// show total memory usage of GPU}
20     \textcolor{keywordtype}{size\_t} free\_byte;
21     \textcolor{keywordtype}{size\_t} total\_byte;
22     cudaError\_t cuda\_status = cudaMemGetInfo( &free\_byte, &total\_byte );
23     \textcolor{keywordflow}{if} ( cudaSuccess != cuda\_status )\{
24         \hyperlink{utils_8cpp_a4a7132c90e490d24edecb391a754a9c0}{dbgprintf}(\textcolor{stringliteral}{"Error: cudaMemGetInfo fails, %s \(\backslash\)n"}, cudaGetErrorString(cuda\_status) );
25         exit(1);
26     \}
27     \textcolor{keywordtype}{double} free\_db = (double)free\_byte;
28     \textcolor{keywordtype}{double} total\_db = (double)total\_byte;
29     \textcolor{keywordtype}{double} used\_db = total\_db - free\_db;
30     \hyperlink{utils_8cpp_a4a7132c90e490d24edecb391a754a9c0}{dbgprintf}(\textcolor{stringliteral}{"%sused = %2.2f MB, free = %2.2f MB, total = %2.2f MB\(\backslash\)n"},
31         info != \textcolor{stringliteral}{""} ? (info+\textcolor{stringliteral}{": "}).c\_str() : \textcolor{stringliteral}{""},
32         used\_db/1024.0/1024.0, free\_db/1024.0/1024.0, total\_db/1024.0/1024.0);
33 \}
\end{DoxyCode}
