\hypertarget{utils_8cpp}{}\section{cputrack/utils.cpp File Reference}
\label{utils_8cpp}\index{cputrack/utils.\+cpp@{cputrack/utils.\+cpp}}
{\ttfamily \#include \char`\"{}std\+\_\+incl.\+h\char`\"{}}\\*
{\ttfamily \#include $<$cstdarg$>$}\\*
{\ttfamily \#include $<$functional$>$}\\*
{\ttfamily \#include \char`\"{}utils.\+h\char`\"{}}\\*
{\ttfamily \#include $<$Windows.\+h$>$}\\*
{\ttfamily \#include $<$string$>$}\\*
{\ttfamily \#include $<$complex$>$}\\*
{\ttfamily \#include \char`\"{}random\+\_\+distr.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}Lsq\+Quadratic\+Fit.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}Queued\+Tracker.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}threads.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}Cubic\+B\+Spline.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}time.\+h\char`\"{}}\\*
{\ttfamily \#include $<$tchar.\+h$>$}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
std\+::string \hyperlink{utils_8cpp_a5db0cac9cdabe121a5e8f63bb22c3cc4}{Get\+Current\+Output\+Path} (bool ext)
\item 
void \hyperlink{utils_8cpp_a54368b144ba7937abad8461e3b467659}{Get\+Formatted\+Time\+String} (char $\ast$output)
\item 
void \hyperlink{utils_8cpp_ab8de7c8e4f80ba5a6b1fcf8da603cd67}{dbgsetlogfile} (const char $\ast$path)
\item 
std\+::string \hyperlink{utils_8cpp_aeb7eb5c2a751102d58ea3d7b15bd5bcf}{Get\+Local\+Module\+Filename} ()
\item 
void \hyperlink{utils_8cpp_a573f566a9717a199b5311d89e75aa010}{Write\+To\+Log} (const char $\ast$str)
\item 
std\+::string \hyperlink{utils_8cpp_abb79ff4e841148f46f68fed19d087169}{Get\+Directory\+From\+Path} (std\+::string fullpath)
\item 
std\+::string \hyperlink{utils_8cpp_a94c5c46fa5ac0e27fa3f171b171fe8ae}{Get\+Local\+Module\+Path} ()
\item 
std\+::string \hyperlink{utils_8cpp_abb4af55bf064f76f19025b5d9a70f723}{file\+\_\+ext} (const char $\ast$f)
\item 
std\+::string \hyperlink{utils_8cpp_aba26a6b64035ef7962a63b760dd9013e}{S\+Printf} (const char $\ast$fmt,...)
\item 
void \hyperlink{utils_8cpp_a5b94ae341d9ebca67ebec2e52e6cc800}{dbgout} (const std\+::string \&s)
\item 
void \hyperlink{utils_8cpp_a4a7132c90e490d24edecb391a754a9c0}{dbgprintf} (const char $\ast$fmt,...)
\item 
void \hyperlink{utils_8cpp_a2bb752417033483e1acda83da3bc800e}{Generate\+Test\+Image} (\hyperlink{_queued_tracker_8h_a2d6726594ce64e82b9222b183f2571d1}{Image\+Data} \&img, float xp, float yp, float size, float S\+Nratio)
\item 
void \hyperlink{utils_8cpp_ab6d583c937db5602a34e949fcf64805d}{Compute\+C\+RP} (float $\ast$dst, int radial\+Steps, int angular\+Steps, float minradius, float maxradius, \hyperlink{std__incl_8h_aba974726076ec2d63a67114c536d123e}{vector2f} center, \hyperlink{_queued_tracker_8h_a2d6726594ce64e82b9222b183f2571d1}{Image\+Data} $\ast$img, float padding\+Value, float $\ast$crpmap)
\item 
float \hyperlink{utils_8cpp_af2c5d75118d6b7de9ac5300c92124b2c}{Compute\+Bg\+Corrected\+C\+O\+M1D} (float $\ast$data, int len, float cf)
\item 
void \hyperlink{utils_8cpp_a404fa660440d30ed70566aebf9f9e94a}{Normalize\+Radial\+Profile} (\hyperlink{scalar__types_8h_a03fcef84665498b9cfcf9c7cc25574e9}{scalar\+\_\+t} $\ast$prof, int rsteps)
\item 
void \hyperlink{utils_8cpp_a394f1ad70cd62465e18850f87c93351c}{Normalize\+Z\+L\+UT} (float $\ast$zlut, int num\+Beads, int planes, int radialsteps)
\item 
void \hyperlink{utils_8cpp_a58b8cd6cf896ba78d6e23d6ead96d1fb}{Compute\+Radial\+Profile} (float $\ast$dst, int radial\+Steps, int angular\+Steps, float minradius, float maxradius, \hyperlink{std__incl_8h_aba974726076ec2d63a67114c536d123e}{vector2f} center, \hyperlink{_queued_tracker_8h_a2d6726594ce64e82b9222b183f2571d1}{Image\+Data} $\ast$img, float mean, bool \hyperlink{utils_8h_a32b5810b69072511c66006593bcf7a89}{normalize})
\item 
float \hyperlink{utils_8cpp_a5d9a285a9ed595c633d5fc06e622df8f}{sq} (float x)
\item 
void \hyperlink{utils_8cpp_af574edb94793976b749c0240c79b1c48}{Generate\+Image\+From\+L\+UT} (\hyperlink{_queued_tracker_8h_a2d6726594ce64e82b9222b183f2571d1}{Image\+Data} $\ast$image, \hyperlink{_queued_tracker_8h_a2d6726594ce64e82b9222b183f2571d1}{Image\+Data} $\ast$zlut, float minradius, float maxradius, \hyperlink{std__incl_8h_a2feaef1d85a74bd5cf80df91b1a9a914}{vector3f} pos, bool spline\+Interp, int oversample\+Subdiv)
\item 
void \hyperlink{utils_8cpp_a6203254588fe20c359c382ba4ddd9627}{Generate\+Gaussian\+Spot\+Image} (\hyperlink{_queued_tracker_8h_a2d6726594ce64e82b9222b183f2571d1}{Image\+Data} $\ast$img, \hyperlink{std__incl_8h_aba974726076ec2d63a67114c536d123e}{vector2f} pos, float sigma, float I0, float Ibg)
\item 
void \hyperlink{utils_8cpp_ac2ddbf383f4539cdec45a8001a435a1a}{Apply\+Poisson\+Noise} (\hyperlink{_queued_tracker_8h_a2d6726594ce64e82b9222b183f2571d1}{Image\+Data} \&img, float poisson\+Max, float maxval)
\item 
void \hyperlink{utils_8cpp_a164d40d76379d0bb95a5ff0dd935aa1f}{Apply\+Gaussian\+Noise} (\hyperlink{_queued_tracker_8h_a2d6726594ce64e82b9222b183f2571d1}{Image\+Data} \&img, float sigma)
\item 
std\+::vector$<$ std\+::vector$<$ float $>$ $>$ \hyperlink{utils_8cpp_a97c4edb27d72c98256ae9ba9d9a92145}{Read\+C\+SV} (const char $\ast$filename, char sep)
\item 
std\+::vector$<$ \hyperlink{std__incl_8h_a2feaef1d85a74bd5cf80df91b1a9a914}{vector3f} $>$ \hyperlink{utils_8cpp_abc30341e16799156a1b3b6093ea7d3d5}{Read\+Vector3\+C\+SV} (const char $\ast$file, char sep)
\item 
void \hyperlink{utils_8cpp_ac53dbc16bbb47e927b088892e806dcf7}{Write\+Trace} (std\+::string filename, \hyperlink{std__incl_8h_a2feaef1d85a74bd5cf80df91b1a9a914}{vector3f} $\ast$results, int n\+Results)
\item 
void \hyperlink{utils_8cpp_aeb2d139686549bd29fe86f72247eecf1}{Write\+Vector\+As\+C\+S\+V\+Row} (const char $\ast$file, std\+::vector$<$ float $>$ d, bool append)
\item 
void \hyperlink{utils_8cpp_aa0fb8da4922e3042928ed9f6388bc09a}{Write\+Array\+As\+C\+S\+V\+Row} (const char $\ast$file, float $\ast$d, int len, bool append)
\item 
void \hyperlink{utils_8cpp_ad594d63fab5898e75c6eeb533368aba8}{Write\+Image\+As\+C\+SV} (const char $\ast$file, float $\ast$d, int w, int h, const char $\ast$labels\mbox{[}$\,$\mbox{]})
\item 
void \hyperlink{utils_8cpp_a1a1189014022a9f0fe2333757512155a}{Write\+Complex\+Image\+As\+C\+SV} (const char $\ast$file, std\+::complex$<$ float $>$ $\ast$d, int w, int h, const char $\ast$labels\mbox{[}$\,$\mbox{]})
\item 
std\+::vector$<$ \hyperlink{std__incl_8h_a65f85814a8290f9797005d3b28e7e5fc}{uchar} $>$ \hyperlink{utils_8cpp_afc3a35e21ebcc6c29a05f25c58c74157}{Read\+To\+Byte\+Buffer} (const char $\ast$filename)
\item 
\hyperlink{_queued_tracker_8h_a2d6726594ce64e82b9222b183f2571d1}{Image\+Data} \hyperlink{utils_8cpp_a9d2506602d1c5b6419101f13380ddb59}{Read\+J\+P\+E\+G\+File} (const char $\ast$fn)
\item 
void \hyperlink{utils_8cpp_aa12cb78bf8b173dab3392d1e16944b6d}{Copy\+Image\+To\+Float} (\hyperlink{std__incl_8h_a65f85814a8290f9797005d3b28e7e5fc}{uchar} $\ast$data, int width, int height, int pitch, \hyperlink{qtrk__c__api_8h_aad82367b3ea592a142bb50a2fb538b0b}{Q\+T\+R\+K\+\_\+\+Pixel\+Data\+Type} pdt, float $\ast$dst)
\item 
double \hyperlink{utils_8cpp_a11abc9edca3542dd4e74dadf99340fa1}{Get\+Precise\+Time} ()
\item 
int \hyperlink{utils_8cpp_a93409977ae90735769d0d2f37b19604e}{Nearest\+Power\+Of2} (int v)
\item 
int \hyperlink{utils_8cpp_a5f7925a9c145be917c154215435e26fc}{Nearest\+Power\+Of3} (int v)
\item 
std\+::vector$<$ float $>$ \hyperlink{utils_8cpp_a8657c1536ca3621943042411f4644e21}{Compute\+Radial\+Bin\+Window} (int rsteps)
\item 
\hyperlink{_queued_tracker_8h_a2d6726594ce64e82b9222b183f2571d1}{Image\+Data} \hyperlink{utils_8cpp_afa12308b716c890001e2b072f45d4a74}{Read\+L\+U\+T\+File} (const char $\ast$lutfile)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static std\+::string \hyperlink{utils_8cpp_ae003eabff7038472981e17852dc6aa82}{log\+Filename}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{utils.\+cpp@{utils.\+cpp}!Apply\+Gaussian\+Noise@{Apply\+Gaussian\+Noise}}
\index{Apply\+Gaussian\+Noise@{Apply\+Gaussian\+Noise}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Apply\+Gaussian\+Noise(\+Image\+Data \&img, float sigma)}{ApplyGaussianNoise(ImageData &img, float sigma)}}]{\setlength{\rightskip}{0pt plus 5cm}void Apply\+Gaussian\+Noise (
\begin{DoxyParamCaption}
\item[{{\bf Image\+Data} \&}]{img, }
\item[{float}]{sigma}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_a164d40d76379d0bb95a5ff0dd935aa1f}{}\label{utils_8cpp_a164d40d76379d0bb95a5ff0dd935aa1f}

\begin{DoxyCode}
459 \{
460     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k=0;k<img.\hyperlink{struct_t_image_data_a778a4b0170c0a225b89692c7cedd2440}{numPixels}();k++) \{
461         \textcolor{keywordtype}{float} v = img.\hyperlink{struct_t_image_data_a78c7415ecee3965da7e25149cea6f4d8}{data}[k] + sigma * rand\_normal<float>();
462         \textcolor{keywordflow}{if} (v<0.0f) v= 0.0f;
463         img.\hyperlink{struct_t_image_data_a78c7415ecee3965da7e25149cea6f4d8}{data}[k]=v;
464     \}
465 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Apply\+Poisson\+Noise@{Apply\+Poisson\+Noise}}
\index{Apply\+Poisson\+Noise@{Apply\+Poisson\+Noise}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Apply\+Poisson\+Noise(\+Image\+Data \&img, float poisson\+Max, float maxval)}{ApplyPoissonNoise(ImageData &img, float poissonMax, float maxval)}}]{\setlength{\rightskip}{0pt plus 5cm}void Apply\+Poisson\+Noise (
\begin{DoxyParamCaption}
\item[{{\bf Image\+Data} \&}]{img, }
\item[{float}]{poisson\+Max, }
\item[{float}]{maxval}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_ac2ddbf383f4539cdec45a8001a435a1a}{}\label{utils_8cpp_ac2ddbf383f4539cdec45a8001a435a1a}

\begin{DoxyCode}
437 \{
438     \textcolor{comment}{/*auto f = [&] (int y) \{}
439 \textcolor{comment}{        for (int x=0;x<img.w;x++) \{}
440 \textcolor{comment}{            img.at(x,y) = rand\_poisson<float>(factor*img.at(x,y));}
441 \textcolor{comment}{        \}}
442 \textcolor{comment}{    \};}
443 \textcolor{comment}{}
444 \textcolor{comment}{    ThreadPool<int, std::function<void (int index)> > pool(f);}
445 \textcolor{comment}{}
446 \textcolor{comment}{    for (int y=0;y<img.h;y++) \{}
447 \textcolor{comment}{        pool.AddWork(y);}
448 \textcolor{comment}{    \}}
449 \textcolor{comment}{    pool.WaitUntilDone();*/}
450 
451     \textcolor{keywordtype}{float} ratio = maxval / poissonMax;
452 
453     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x=0;x<img.\hyperlink{struct_t_image_data_a778a4b0170c0a225b89692c7cedd2440}{numPixels}();x++) \{
454         img[x] = (int)(rand\_poisson<float>(poissonMax*img[x]) * ratio );
455     \}
456 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Compute\+Bg\+Corrected\+C\+O\+M1D@{Compute\+Bg\+Corrected\+C\+O\+M1D}}
\index{Compute\+Bg\+Corrected\+C\+O\+M1D@{Compute\+Bg\+Corrected\+C\+O\+M1D}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Compute\+Bg\+Corrected\+C\+O\+M1\+D(float $\ast$data, int len, float cf)}{ComputeBgCorrectedCOM1D(float *data, int len, float cf)}}]{\setlength{\rightskip}{0pt plus 5cm}float Compute\+Bg\+Corrected\+C\+O\+M1D (
\begin{DoxyParamCaption}
\item[{float $\ast$}]{data, }
\item[{int}]{len, }
\item[{float}]{cf}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_af2c5d75118d6b7de9ac5300c92124b2c}{}\label{utils_8cpp_af2c5d75118d6b7de9ac5300c92124b2c}

\begin{DoxyCode}
234 \{
235     \textcolor{keywordtype}{float} sum=0, sum2=0;
236     \textcolor{keywordtype}{float} moment=0;
237 
238     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x=0;x<len;x++) \{
239         \textcolor{keywordtype}{float} v = data[x];
240         sum += v;
241         sum2 += v*v;
242     \}
243 
244     \textcolor{keywordtype}{float} invN = 1.0f/len;
245     \textcolor{keywordtype}{float} mean = sum * invN;
246     \textcolor{keywordtype}{float} stdev = sqrtf(sum2 * invN - mean * mean);
247     sum = 0.0f;
248 
249     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} x=0;x<len;x++)
250     \{
251         \textcolor{keywordtype}{float} v = data[x];
252         v = std::max(0.0f, fabs(v-mean)-cf*stdev);
253         sum += v;
254         moment += x*v;
255     \}
256     \textcolor{keywordflow}{return} moment / (float)sum;
257 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Compute\+C\+RP@{Compute\+C\+RP}}
\index{Compute\+C\+RP@{Compute\+C\+RP}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Compute\+C\+R\+P(float $\ast$dst, int radial\+Steps, int angular\+Steps, float minradius, float maxradius, vector2f center, Image\+Data $\ast$img, float padding\+Value, float $\ast$crpmap)}{ComputeCRP(float *dst, int radialSteps, int angularSteps, float minradius, float maxradius, vector2f center, ImageData *img, float paddingValue, float *crpmap)}}]{\setlength{\rightskip}{0pt plus 5cm}void Compute\+C\+RP (
\begin{DoxyParamCaption}
\item[{float $\ast$}]{dst, }
\item[{int}]{radial\+Steps, }
\item[{int}]{angular\+Steps, }
\item[{float}]{minradius, }
\item[{float}]{maxradius, }
\item[{{\bf vector2f}}]{center, }
\item[{{\bf Image\+Data} $\ast$}]{img, }
\item[{float}]{padding\+Value, }
\item[{float $\ast$}]{crpmap}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_ab6d583c937db5602a34e949fcf64805d}{}\label{utils_8cpp_ab6d583c937db5602a34e949fcf64805d}

\begin{DoxyCode}
185 \{
186     \hyperlink{structvector2}{vector2f}* radialDirs = (\hyperlink{structvector2}{vector2f}*)\hyperlink{std__incl_8h_a72fc0ed307a114ba9a46ebd095267d2f}{ALLOCA}(\textcolor{keyword}{sizeof}(
      \hyperlink{structvector2}{vector2f})*angularSteps);
187     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0;j<angularSteps;j++) \{
188         \textcolor{keywordtype}{float} ang = 2*3.141593f*j/(float)angularSteps;
189         radialDirs[j] = \hyperlink{std__incl_8h_aba974726076ec2d63a67114c536d123e}{vector2f}(cosf(ang), sinf(ang) );
190     \}
191 
192     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<radialSteps;i++)
193         dst[i]=0.0f;
194 
195     \textcolor{keywordtype}{float}* map = crpmap ? crpmap : (\textcolor{keywordtype}{float}*)\hyperlink{std__incl_8h_a72fc0ed307a114ba9a46ebd095267d2f}{ALLOCA}(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float})*radialSteps*angularSteps);
196     \textcolor{keywordtype}{float}* com = (\textcolor{keywordtype}{float}*)\hyperlink{std__incl_8h_a72fc0ed307a114ba9a46ebd095267d2f}{ALLOCA}(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float})*angularSteps);
197 
198     \textcolor{keywordtype}{float} rstep = (maxradius-minradius) / radialSteps;
199     \textcolor{keywordtype}{float} comsum = 0.0f;
200     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} a=0;a<angularSteps;a++) \{
201         \textcolor{keywordtype}{float} r = minradius;
202         \textcolor{keywordtype}{float} sum = 0.0f, moment=0.0f;
203         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<radialSteps; i++) \{
204             \textcolor{keywordtype}{float} x = center.\hyperlink{structvector2_a22b63498d8e4abf9a2da054a247965b9}{x} + radialDirs[a].\hyperlink{structvector2_a22b63498d8e4abf9a2da054a247965b9}{x} * r;
205             \textcolor{keywordtype}{float} y = center.\hyperlink{structvector2_a00b3268bc895adddf0b72d6acd8274a7}{y} + radialDirs[a].\hyperlink{structvector2_a00b3268bc895adddf0b72d6acd8274a7}{y} * r;
206             \textcolor{keywordtype}{float} v = img->\hyperlink{struct_t_image_data_ac92ac7641d694ac8842bbf4b186ad49a}{interpolate}(x,y);
207             r += rstep;
208             map[a*radialSteps+i] = v;
209             sum += v;
210             moment += i*v;
211         \}
212         com[a] = moment/sum;
213         comsum += com[a];
214     \}
215     \textcolor{keywordtype}{float} avgcom = comsum/angularSteps;
216     \textcolor{keywordtype}{float} totalrmssum2 = 0.0f;
217     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<radialSteps; i++) \{
218         \textcolor{keywordtype}{double} sum = 0.0f;
219         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} a=0;a<angularSteps;a++) \{
220             \textcolor{keywordtype}{float} shift = com[a]-avgcom;
221             sum += map[a*radialSteps+i];
222         \}
223         dst[i] = sum/angularSteps-paddingValue;
224         totalrmssum2 += dst[i]*dst[i];
225     \}
226     \textcolor{keywordtype}{double} invTotalrms = 1.0f/\hyperlink{std__incl_8h_a8a38721046513951c4bfc32bf101e180}{sqrt}(totalrmssum2/radialSteps);
227     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<radialSteps;i++) \{
228         dst[i] *= invTotalrms;
229     \}
230 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Compute\+Radial\+Bin\+Window@{Compute\+Radial\+Bin\+Window}}
\index{Compute\+Radial\+Bin\+Window@{Compute\+Radial\+Bin\+Window}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Compute\+Radial\+Bin\+Window(int rsteps)}{ComputeRadialBinWindow(int rsteps)}}]{\setlength{\rightskip}{0pt plus 5cm}std\+::vector$<$float$>$ Compute\+Radial\+Bin\+Window (
\begin{DoxyParamCaption}
\item[{int}]{rsteps}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_a8657c1536ca3621943042411f4644e21}{}\label{utils_8cpp_a8657c1536ca3621943042411f4644e21}

\begin{DoxyCode}
714 \{
715     std::vector<float> wnd(rsteps);
716     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<rsteps;i++) \{
717         \textcolor{keywordtype}{float} x = i/(float)rsteps;
718         \textcolor{keywordtype}{float} t2 = 0.05f; 
719         \textcolor{keywordtype}{float} t1 = 0.01f;
720         \textcolor{keywordtype}{float} fall = 1.0f-expf(-\hyperlink{utils_8cpp_a5d9a285a9ed595c633d5fc06e622df8f}{sq}(1-x)/t2);
721         \textcolor{keywordtype}{float} rise = 1.0f-expf(-\hyperlink{utils_8cpp_a5d9a285a9ed595c633d5fc06e622df8f}{sq}(x)/t1);
722         wnd[i] = sqrtf(fall*rise*x*2);
723     \}
724     \textcolor{keywordflow}{return} wnd;
725 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Compute\+Radial\+Profile@{Compute\+Radial\+Profile}}
\index{Compute\+Radial\+Profile@{Compute\+Radial\+Profile}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Compute\+Radial\+Profile(float $\ast$dst, int radial\+Steps, int angular\+Steps, float minradius, float maxradius, vector2f center, Image\+Data $\ast$img, float mean, bool normalize)}{ComputeRadialProfile(float *dst, int radialSteps, int angularSteps, float minradius, float maxradius, vector2f center, ImageData *img, float mean, bool normalize)}}]{\setlength{\rightskip}{0pt plus 5cm}void Compute\+Radial\+Profile (
\begin{DoxyParamCaption}
\item[{float $\ast$}]{dst, }
\item[{int}]{radial\+Steps, }
\item[{int}]{angular\+Steps, }
\item[{float}]{minradius, }
\item[{float}]{maxradius, }
\item[{{\bf vector2f}}]{center, }
\item[{{\bf Image\+Data} $\ast$}]{img, }
\item[{float}]{mean, }
\item[{bool}]{normalize}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_a58b8cd6cf896ba78d6e23d6ead96d1fb}{}\label{utils_8cpp_a58b8cd6cf896ba78d6e23d6ead96d1fb}

\begin{DoxyCode}
302 \{
303     \hyperlink{structvector2}{vector2f}* radialDirs = (\hyperlink{structvector2}{vector2f}*)\hyperlink{std__incl_8h_a72fc0ed307a114ba9a46ebd095267d2f}{ALLOCA}(\textcolor{keyword}{sizeof}(
      \hyperlink{structvector2}{vector2f})*angularSteps);
304     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0;j<angularSteps;j++) \{
305         \textcolor{keywordtype}{float} ang = 2*3.141593f*j/(float)angularSteps;
306         radialDirs[j] = \hyperlink{std__incl_8h_aba974726076ec2d63a67114c536d123e}{vector2f}(cosf(ang), sinf(ang));
307     \}
308 
309     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<radialSteps;i++)
310         dst[i]=0.0f;
311 
312 \textcolor{comment}{//  center.x += 0.5f;}
313 \textcolor{comment}{//  center.y += 0.5f;}
314 
315     \textcolor{keywordtype}{bool} trace=\textcolor{keyword}{false};
316     \textcolor{keywordtype}{float} rstep = (maxradius-minradius) / radialSteps;
317     \textcolor{keywordtype}{int} totalsmp = 0;
318 
319     \textcolor{comment}{//FILE* f = fopen("D:\(\backslash\)\(\backslash\)TestImages\(\backslash\)\(\backslash\)test.csv","w");}
320 
321     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<radialSteps; i++) \{
322         \textcolor{keywordtype}{double} sum = 0.0f;
323 
324         \textcolor{keywordtype}{int} nsamples = 0;
325         \textcolor{keywordtype}{float} r = minradius+rstep*i;
326         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} a=0;a<angularSteps;a++) \{
327             \textcolor{keywordtype}{float} x = center.\hyperlink{structvector2_a22b63498d8e4abf9a2da054a247965b9}{x} + radialDirs[a].\hyperlink{structvector2_a22b63498d8e4abf9a2da054a247965b9}{x} * r;
328             \textcolor{keywordtype}{float} y = center.\hyperlink{structvector2_a00b3268bc895adddf0b72d6acd8274a7}{y} + radialDirs[a].\hyperlink{structvector2_a00b3268bc895adddf0b72d6acd8274a7}{y} * r;
329             \textcolor{keywordtype}{bool} outside;
330             \textcolor{keywordtype}{float} v = img->\hyperlink{struct_t_image_data_ac92ac7641d694ac8842bbf4b186ad49a}{interpolate}(x,y, &outside);
331             \textcolor{keywordflow}{if} (!outside) \{
332                 sum += v;
333                 nsamples++;
334             \}
335 
336             \textcolor{comment}{//fprintf(f,"%d\(\backslash\)t%d\(\backslash\)t%f\(\backslash\)n",i,a,v);}
337         \}
338 
339         \textcolor{keywordflow}{if} (trace) \{
340             \hyperlink{utils_8cpp_a4a7132c90e490d24edecb391a754a9c0}{dbgprintf}(\textcolor{stringliteral}{"%f,[%d]; "}, sum, nsamples);
341         \}
342 
343         dst[i] = nsamples > \hyperlink{_queued_tracker_8h_a1625167c310599739f4d73170413e64a}{MIN\_RADPROFILE\_SMP\_COUNT} ? sum/nsamples : mean;
344     \}
345     \textcolor{keywordflow}{if}(trace)
346         \hyperlink{utils_8cpp_a4a7132c90e490d24edecb391a754a9c0}{dbgprintf}(\textcolor{stringliteral}{"\(\backslash\)n"});
347 
348     \textcolor{comment}{//fclose(f);}
349 
350     \textcolor{keywordflow}{if} (\hyperlink{utils_8h_a32b5810b69072511c66006593bcf7a89}{normalize}) 
351         \hyperlink{utils_8cpp_a404fa660440d30ed70566aebf9f9e94a}{NormalizeRadialProfile}(dst, radialSteps);
352 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Copy\+Image\+To\+Float@{Copy\+Image\+To\+Float}}
\index{Copy\+Image\+To\+Float@{Copy\+Image\+To\+Float}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Copy\+Image\+To\+Float(uchar $\ast$data, int width, int height, int pitch, Q\+T\+R\+K\+\_\+\+Pixel\+Data\+Type pdt, float $\ast$dst)}{CopyImageToFloat(uchar *data, int width, int height, int pitch, QTRK_PixelDataType pdt, float *dst)}}]{\setlength{\rightskip}{0pt plus 5cm}void Copy\+Image\+To\+Float (
\begin{DoxyParamCaption}
\item[{{\bf uchar} $\ast$}]{data, }
\item[{int}]{width, }
\item[{int}]{height, }
\item[{int}]{pitch, }
\item[{{\bf Q\+T\+R\+K\+\_\+\+Pixel\+Data\+Type}}]{pdt, }
\item[{float $\ast$}]{dst}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_aa12cb78bf8b173dab3392d1e16944b6d}{}\label{utils_8cpp_aa12cb78bf8b173dab3392d1e16944b6d}

\begin{DoxyCode}
650 \{
651     \textcolor{keywordflow}{if} (pdt == \hyperlink{qtrk__c__api_8h_aad82367b3ea592a142bb50a2fb538b0baed6124f6daf00bc0e0f4817986bad3a1}{QTrkU8}) \{
652         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y=0;y<height;y++) \{
653             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x=0;x<width;x++)
654                 dst[x] = data[x];
655             data += pitch;
656             dst += width;
657         \}
658     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(pdt == \hyperlink{qtrk__c__api_8h_aad82367b3ea592a142bb50a2fb538b0ba6c91530bb59effda68594063a7a1d5a6}{QTrkU16}) \{
659         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y=0;y<height;y++) \{
660             \hyperlink{std__incl_8h_ab95f123a6c9bcfee6a343170ef8c5f69}{ushort}* u = (\hyperlink{std__incl_8h_ab95f123a6c9bcfee6a343170ef8c5f69}{ushort}*)data;
661             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x=0;x<width;x++)
662                 dst[x] = u[x];
663             data += pitch;
664             dst += width;
665         \}
666     \} \textcolor{keywordflow}{else} \{
667         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y=0;y<height;y++) \{
668             \textcolor{keywordtype}{float}* fsrc = (\textcolor{keywordtype}{float}*)data;
669             \textcolor{keywordflow}{for}( \textcolor{keywordtype}{int} x=0;x<width;x++)
670                 dst[x] = fsrc[x];
671             data += pitch;
672             dst += width;
673         \}
674     \}
675 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!dbgout@{dbgout}}
\index{dbgout@{dbgout}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{dbgout(const std\+::string \&s)}{dbgout(const std::string &s)}}]{\setlength{\rightskip}{0pt plus 5cm}void dbgout (
\begin{DoxyParamCaption}
\item[{const std\+::string \&}]{s}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_a5b94ae341d9ebca67ebec2e52e6cc800}{}\label{utils_8cpp_a5b94ae341d9ebca67ebec2e52e6cc800}

\begin{DoxyCode}
143                                 \{
144     OutputDebugString(s.c\_str());
145     printf(s.c\_str());
146     \hyperlink{utils_8cpp_a573f566a9717a199b5311d89e75aa010}{WriteToLog}(s.c\_str());
147 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!dbgprintf@{dbgprintf}}
\index{dbgprintf@{dbgprintf}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{dbgprintf(const char $\ast$fmt,...)}{dbgprintf(const char *fmt,...)}}]{\setlength{\rightskip}{0pt plus 5cm}void dbgprintf (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{fmt, }
\item[{}]{...}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_a4a7132c90e490d24edecb391a754a9c0}{}\label{utils_8cpp_a4a7132c90e490d24edecb391a754a9c0}

\begin{DoxyCode}
149                                     \{
150     va\_list ap;
151     va\_start(ap, fmt);
152 
153     \textcolor{keywordtype}{char} buf[512];
154     \hyperlink{std__incl_8h_ac2e4f48c3da557e8b268aee96009e135}{VSNPRINTF}(buf, \textcolor{keyword}{sizeof}(buf), fmt, ap);
155     OutputDebugString(buf);
156     fputs(buf,stdout);
157     \hyperlink{utils_8cpp_a573f566a9717a199b5311d89e75aa010}{WriteToLog}(buf);
158 
159     va\_end(ap);
160 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!dbgsetlogfile@{dbgsetlogfile}}
\index{dbgsetlogfile@{dbgsetlogfile}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{dbgsetlogfile(const char $\ast$path)}{dbgsetlogfile(const char *path)}}]{\setlength{\rightskip}{0pt plus 5cm}void dbgsetlogfile (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{path}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_ab8de7c8e4f80ba5a6b1fcf8da603cd67}{}\label{utils_8cpp_ab8de7c8e4f80ba5a6b1fcf8da603cd67}

\begin{DoxyCode}
50 \{
51     \hyperlink{utils_8cpp_ae003eabff7038472981e17852dc6aa82}{logFilename} = path;
52 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!file\+\_\+ext@{file\+\_\+ext}}
\index{file\+\_\+ext@{file\+\_\+ext}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{file\+\_\+ext(const char $\ast$f)}{file_ext(const char *f)}}]{\setlength{\rightskip}{0pt plus 5cm}std\+::string file\+\_\+ext (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{f}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_abb4af55bf064f76f19025b5d9a70f723}{}\label{utils_8cpp_abb4af55bf064f76f19025b5d9a70f723}

\begin{DoxyCode}
121                                  \{
122     \textcolor{keywordtype}{int} l=strlen(f)-1;
123     \textcolor{keywordflow}{while} (l > 0) \{
124         \textcolor{keywordflow}{if} (f[l] == \textcolor{charliteral}{'.'})
125             \textcolor{keywordflow}{return} &f[l+1];
126         l--;
127     \}
128     \textcolor{keywordflow}{return} \textcolor{stringliteral}{""};
129 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Generate\+Gaussian\+Spot\+Image@{Generate\+Gaussian\+Spot\+Image}}
\index{Generate\+Gaussian\+Spot\+Image@{Generate\+Gaussian\+Spot\+Image}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Generate\+Gaussian\+Spot\+Image(\+Image\+Data $\ast$img, vector2f pos, float sigma, float I0, float Ibg)}{GenerateGaussianSpotImage(ImageData *img, vector2f pos, float sigma, float I0, float Ibg)}}]{\setlength{\rightskip}{0pt plus 5cm}void Generate\+Gaussian\+Spot\+Image (
\begin{DoxyParamCaption}
\item[{{\bf Image\+Data} $\ast$}]{img, }
\item[{{\bf vector2f}}]{pos, }
\item[{float}]{sigma, }
\item[{float}]{I0, }
\item[{float}]{Ibg}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_a6203254588fe20c359c382ba4ddd9627}{}\label{utils_8cpp_a6203254588fe20c359c382ba4ddd9627}

\begin{DoxyCode}
426 \{
427     \textcolor{keywordtype}{float} edenom = 1/\hyperlink{std__incl_8h_a8a38721046513951c4bfc32bf101e180}{sqrt}(2*sigma*sigma);
428     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y=0;y<img->\hyperlink{struct_t_image_data_a252235d07e487e8d02908aed062147bd}{h};y++)
429         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} x=0;x<img->\hyperlink{struct_t_image_data_aa46faa6f66f9d6f93c65e14aea643eb3}{w};x++) \{
430             \textcolor{keywordtype}{float} DeltaX = 0.5f * \hyperlink{utils_8h_ab395c4718c08b423258c297fe9b1cae8}{erf}( (x-pos.\hyperlink{structvector2_a22b63498d8e4abf9a2da054a247965b9}{x} + .5f) * edenom ) - 0.5f * 
      \hyperlink{utils_8h_ab395c4718c08b423258c297fe9b1cae8}{erf}((x-pos.\hyperlink{structvector2_a22b63498d8e4abf9a2da054a247965b9}{x} - .5f) * edenom);
431             \textcolor{keywordtype}{float} DeltaY = 0.5f * \hyperlink{utils_8h_ab395c4718c08b423258c297fe9b1cae8}{erf}( (y-pos.\hyperlink{structvector2_a00b3268bc895adddf0b72d6acd8274a7}{y} + .5f) * edenom ) - 0.5f * 
      \hyperlink{utils_8h_ab395c4718c08b423258c297fe9b1cae8}{erf}((y-pos.\hyperlink{structvector2_a00b3268bc895adddf0b72d6acd8274a7}{y} - .5f) * edenom);
432             img->\hyperlink{struct_t_image_data_ad13c1527ffabe17b997c38090ec5e6b9}{at}(x,y) = Ibg + I0 * DeltaX * DeltaY;
433         \}
434 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Generate\+Image\+From\+L\+UT@{Generate\+Image\+From\+L\+UT}}
\index{Generate\+Image\+From\+L\+UT@{Generate\+Image\+From\+L\+UT}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Generate\+Image\+From\+L\+U\+T(\+Image\+Data $\ast$image, Image\+Data $\ast$zlut, float minradius, float maxradius, vector3f pos, bool spline\+Interp, int oversample\+Subdiv)}{GenerateImageFromLUT(ImageData *image, ImageData *zlut, float minradius, float maxradius, vector3f pos, bool splineInterp, int oversampleSubdiv)}}]{\setlength{\rightskip}{0pt plus 5cm}void Generate\+Image\+From\+L\+UT (
\begin{DoxyParamCaption}
\item[{{\bf Image\+Data} $\ast$}]{image, }
\item[{{\bf Image\+Data} $\ast$}]{zlut, }
\item[{float}]{minradius, }
\item[{float}]{maxradius, }
\item[{{\bf vector3f}}]{pos, }
\item[{bool}]{spline\+Interp, }
\item[{int}]{oversample\+Subdiv}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_af574edb94793976b749c0240c79b1c48}{}\label{utils_8cpp_af574edb94793976b749c0240c79b1c48}

\begin{DoxyCode}
358 \{
359 \textcolor{comment}{//  lut.w = radialcov * ( (image->w/2 * roicov ) - minradius );}
360 \textcolor{comment}{//  lut.w = radialcov * ( maxradius - minradius );}
361 
362     \textcolor{keywordtype}{float} radialcov = zlut->\hyperlink{struct_t_image_data_aa46faa6f66f9d6f93c65e14aea643eb3}{w} / (maxradius-minradius);
363     \textcolor{keywordtype}{float}* zinterp = (\textcolor{keywordtype}{float}*)\hyperlink{std__incl_8h_a72fc0ed307a114ba9a46ebd095267d2f}{ALLOCA}(zlut->\hyperlink{struct_t_image_data_aa46faa6f66f9d6f93c65e14aea643eb3}{w} * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float}));
364 
365     \textcolor{keywordflow}{if} (splineInterp) \{
366         \textcolor{keywordtype}{int} iz = std::max(1, std::min(zlut->\hyperlink{struct_t_image_data_a252235d07e487e8d02908aed062147bd}{h}-3, (\textcolor{keywordtype}{int})pos.\hyperlink{structvector3_a90c50e80a32423d5cc76f40e5f53ffbe}{z}));
367         \textcolor{keywordtype}{float} weights[4];
368         \textcolor{keywordtype}{float} fz = pos.\hyperlink{structvector3_a90c50e80a32423d5cc76f40e5f53ffbe}{z}-iz;
369         \hyperlink{_cubic_b_spline_8h_a9eba800c8695b13f0a31ab6ef429d171}{ComputeBSplineWeights}(weights, fz);
370         \textcolor{comment}{// Interpolate ZLUT using B-spline weights}
371         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} r=0;r<zlut->\hyperlink{struct_t_image_data_aa46faa6f66f9d6f93c65e14aea643eb3}{w};r++) \{
372             \textcolor{keywordtype}{float} zlutv = 0;
373             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<4;i++)
374                 zlutv += weights[i] * zlut->\hyperlink{struct_t_image_data_ad13c1527ffabe17b997c38090ec5e6b9}{at}(r, i-1+iz);
375             zinterp[r] = zlutv;
376         \}
377     \}
378     \textcolor{keywordflow}{else} \{
379         \textcolor{comment}{// The two Z planes to interpolate between}
380         \textcolor{keywordtype}{int} iz = (int)pos.\hyperlink{structvector3_a90c50e80a32423d5cc76f40e5f53ffbe}{z};
381         if (iz < 0) 
382             zinterp = zlut->\hyperlink{struct_t_image_data_a78c7415ecee3965da7e25149cea6f4d8}{data};
383         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (iz>=zlut->\hyperlink{struct_t_image_data_a252235d07e487e8d02908aed062147bd}{h}-1)
384             zinterp = &zlut->\hyperlink{struct_t_image_data_a78c7415ecee3965da7e25149cea6f4d8}{data}[ (zlut->\hyperlink{struct_t_image_data_a252235d07e487e8d02908aed062147bd}{h}-1)*zlut->\hyperlink{struct_t_image_data_aa46faa6f66f9d6f93c65e14aea643eb3}{w} ];
385         \textcolor{keywordflow}{else} \{
386             \textcolor{keywordtype}{float}* zlut0 = &zlut->\hyperlink{struct_t_image_data_a78c7415ecee3965da7e25149cea6f4d8}{data} [ (\textcolor{keywordtype}{int})pos.\hyperlink{structvector3_a90c50e80a32423d5cc76f40e5f53ffbe}{z} * zlut->\hyperlink{struct_t_image_data_aa46faa6f66f9d6f93c65e14aea643eb3}{w} ]; 
387             \textcolor{keywordtype}{float}* zlut1 = &zlut->\hyperlink{struct_t_image_data_a78c7415ecee3965da7e25149cea6f4d8}{data} [ ((int)pos.\hyperlink{structvector3_a90c50e80a32423d5cc76f40e5f53ffbe}{z} + 1) * zlut->\hyperlink{struct_t_image_data_aa46faa6f66f9d6f93c65e14aea643eb3}{w} ];
388             zinterp = (\textcolor{keywordtype}{float}*)\hyperlink{std__incl_8h_a72fc0ed307a114ba9a46ebd095267d2f}{ALLOCA}(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float})*zlut->\hyperlink{struct_t_image_data_aa46faa6f66f9d6f93c65e14aea643eb3}{w});
389             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} r=0;r<zlut->\hyperlink{struct_t_image_data_aa46faa6f66f9d6f93c65e14aea643eb3}{w};r++) 
390                 zinterp[r] = \hyperlink{utils_8h_a19361b487ecc29968d6a8924f5601bfa}{Lerp}(zlut0[r], zlut1[r], pos.\hyperlink{structvector3_a90c50e80a32423d5cc76f40e5f53ffbe}{z}-iz);
391         \}
392     \}
393 
394     \textcolor{keywordtype}{int} oversampleWidth=oversampleSubdiv,oversampleHeight=oversampleSubdiv;
395     \textcolor{keywordtype}{float} oxstep = 1.0f / oversampleWidth;
396     \textcolor{keywordtype}{float} oystep = 1.0f / oversampleHeight;
397 
398     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y=0;y<image->\hyperlink{struct_t_image_data_a252235d07e487e8d02908aed062147bd}{h};y++)
399         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x=0;x<image->\hyperlink{struct_t_image_data_aa46faa6f66f9d6f93c65e14aea643eb3}{w};x++) 
400         \{
401             \textcolor{keywordtype}{float} s = 0.0f;
402 
403             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} ox=0;ox<oversampleWidth;ox++)
404                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} oy=0;oy<oversampleHeight;oy++) \{
405 
406                     \textcolor{keywordtype}{float} X = x+(ox+0.5f)*oxstep - pos.\hyperlink{structvector3_a5b466692e9550284d17a1bee6a6b8518}{x} - 0.5f;
407                     \textcolor{keywordtype}{float} Y = y+(oy+0.5f)*oystep - pos.\hyperlink{structvector3_a1faa20a703bae3d1a673856466758383}{y} - 0.5f;
408 
409                     \textcolor{keywordtype}{float} pixr = sqrtf(X*X+Y*Y);
410                     \textcolor{keywordtype}{float} r = (pixr - minradius) * radialcov;
411 
412                     \textcolor{keywordflow}{if} (r > zlut->\hyperlink{struct_t_image_data_aa46faa6f66f9d6f93c65e14aea643eb3}{w}-2)
413                         r = zlut->\hyperlink{struct_t_image_data_aa46faa6f66f9d6f93c65e14aea643eb3}{w}-2;
414                     \textcolor{keywordflow}{if} (r < 0) r = 0;
415 
416                     \textcolor{keywordtype}{int} i=(int)r;
417                     s += \hyperlink{utils_8h_a19361b487ecc29968d6a8924f5601bfa}{Lerp}(zinterp[i], zinterp[i+1], r-i);
418                 \}
419         
420             image->\hyperlink{struct_t_image_data_ad13c1527ffabe17b997c38090ec5e6b9}{at}(x,y) = s/(oversampleWidth*oversampleHeight); 
421         \}
422 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Generate\+Test\+Image@{Generate\+Test\+Image}}
\index{Generate\+Test\+Image@{Generate\+Test\+Image}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Generate\+Test\+Image(\+Image\+Data \&img, float xp, float yp, float size, float S\+Nratio)}{GenerateTestImage(ImageData &img, float xp, float yp, float size, float SNratio)}}]{\setlength{\rightskip}{0pt plus 5cm}void Generate\+Test\+Image (
\begin{DoxyParamCaption}
\item[{{\bf Image\+Data} \&}]{img, }
\item[{float}]{xp, }
\item[{float}]{yp, }
\item[{float}]{size, }
\item[{float}]{S\+Nratio}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_a2bb752417033483e1acda83da3bc800e}{}\label{utils_8cpp_a2bb752417033483e1acda83da3bc800e}

\begin{DoxyCode}
163 \{
164     \textcolor{keywordtype}{float} S = 1.0f/\hyperlink{std__incl_8h_a8a38721046513951c4bfc32bf101e180}{sqrt}(size);
165     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y=0;y<img.\hyperlink{struct_t_image_data_a252235d07e487e8d02908aed062147bd}{h};y++) \{
166         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x=0;x<img.\hyperlink{struct_t_image_data_aa46faa6f66f9d6f93c65e14aea643eb3}{w};x++) \{
167             \textcolor{keywordtype}{float} X = x - xp;\textcolor{comment}{// + 0.5;}
168             \textcolor{keywordtype}{float} Y = y - yp;\textcolor{comment}{// + 0.5;}
169             \textcolor{keywordtype}{float} r = sqrtf(X*X+Y*Y)+1;
170             \textcolor{keywordtype}{float} v = sinf(r/(5*S)) * expf(-r*r*S*0.001f);
171             img.\hyperlink{struct_t_image_data_ad13c1527ffabe17b997c38090ec5e6b9}{at}(x,y)=v;
172         \}
173     \}
174 
175     \textcolor{keywordflow}{if} (SNratio>0) \{
176         \hyperlink{utils_8cpp_a164d40d76379d0bb95a5ff0dd935aa1f}{ApplyGaussianNoise}(img, 1.0f/SNratio);
177     \}
178     img.\hyperlink{struct_t_image_data_ac987182fb87787d7d274a30cf4a198d4}{normalize}();
179 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Get\+Current\+Output\+Path@{Get\+Current\+Output\+Path}}
\index{Get\+Current\+Output\+Path@{Get\+Current\+Output\+Path}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Get\+Current\+Output\+Path(bool ext)}{GetCurrentOutputPath(bool ext)}}]{\setlength{\rightskip}{0pt plus 5cm}std\+::string Get\+Current\+Output\+Path (
\begin{DoxyParamCaption}
\item[{bool}]{ext}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_a5db0cac9cdabe121a5e8f63bb22c3cc4}{}\label{utils_8cpp_a5db0cac9cdabe121a5e8f63bb22c3cc4}

\begin{DoxyCode}
20 \{
21     std::string base = \textcolor{stringliteral}{"D:\(\backslash\)\(\backslash\)TestImages\(\backslash\)\(\backslash\)TestOutput\(\backslash\)\(\backslash\)"};
22     std::string search = base + \textcolor{stringliteral}{"*"};
23     LPCSTR w\_folder = \_T(search.c\_str());
24     
25     WIN32\_FIND\_DATA FindFileData;
26     HANDLE hFind;
27     
28     hFind = FindFirstFile(w\_folder,&FindFileData);
29     std::string dirName;
30     \textcolor{keywordflow}{while}(FindNextFile(hFind,&FindFileData))
31         dirName = FindFileData.cFileName;
32     \textcolor{keywordflow}{if}(ext)
33         \textcolor{keywordflow}{return} \hyperlink{utils_8cpp_aba26a6b64035ef7962a63b760dd9013e}{SPrintf}(\textcolor{stringliteral}{"%s%s\(\backslash\)\(\backslash\)%s"},base.c\_str(),dirName.c\_str(),\textcolor{stringliteral}{"ZLUTDiag\(\backslash\)\(\backslash\)"});
34     \textcolor{keywordflow}{else}
35         \textcolor{keywordflow}{return} \hyperlink{utils_8cpp_aba26a6b64035ef7962a63b760dd9013e}{SPrintf}(\textcolor{stringliteral}{"%s%s"},base.c\_str(),dirName.c\_str());
36 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Get\+Directory\+From\+Path@{Get\+Directory\+From\+Path}}
\index{Get\+Directory\+From\+Path@{Get\+Directory\+From\+Path}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Get\+Directory\+From\+Path(std\+::string fullpath)}{GetDirectoryFromPath(std::string fullpath)}}]{\setlength{\rightskip}{0pt plus 5cm}std\+::string Get\+Directory\+From\+Path (
\begin{DoxyParamCaption}
\item[{std\+::string}]{fullpath}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_abb79ff4e841148f46f68fed19d087169}{}\label{utils_8cpp_abb79ff4e841148f46f68fed19d087169}

\begin{DoxyCode}
105 \{
106     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=fullpath.size()-1;i>=0;i--) \{
107         \textcolor{keywordflow}{if} (fullpath[i] == \textcolor{charliteral}{'/'} || fullpath[i] == \textcolor{charliteral}{'\(\backslash\)\(\backslash\)'}) \{
108             \textcolor{keywordflow}{return} fullpath.substr(0, i);
109         \}
110     \}
111     \textcolor{keywordflow}{return} \textcolor{stringliteral}{""};
112 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Get\+Formatted\+Time\+String@{Get\+Formatted\+Time\+String}}
\index{Get\+Formatted\+Time\+String@{Get\+Formatted\+Time\+String}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Get\+Formatted\+Time\+String(char $\ast$output)}{GetFormattedTimeString(char *output)}}]{\setlength{\rightskip}{0pt plus 5cm}void Get\+Formatted\+Time\+String (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{output}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_a54368b144ba7937abad8461e3b467659}{}\label{utils_8cpp_a54368b144ba7937abad8461e3b467659}

\begin{DoxyCode}
39 \{
40     time\_t rawtime;
41     \textcolor{keyword}{struct }tm * timeinfo;
42     time(&rawtime);
43     timeinfo = localtime(&rawtime);
44     sprintf(output, \textcolor{stringliteral}{"%02d%02d%02d-%02d%02d%02d"},timeinfo->tm\_year-100,timeinfo->tm\_mon+1,timeinfo->tm\_mday,
      timeinfo->tm\_hour,timeinfo->tm\_min,timeinfo->tm\_sec);
45 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Get\+Local\+Module\+Filename@{Get\+Local\+Module\+Filename}}
\index{Get\+Local\+Module\+Filename@{Get\+Local\+Module\+Filename}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Get\+Local\+Module\+Filename()}{GetLocalModuleFilename()}}]{\setlength{\rightskip}{0pt plus 5cm}std\+::string Get\+Local\+Module\+Filename (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_aeb7eb5c2a751102d58ea3d7b15bd5bcf}{}\label{utils_8cpp_aeb7eb5c2a751102d58ea3d7b15bd5bcf}

\begin{DoxyCode}
55 \{
56 \textcolor{preprocessor}{#ifdef WIN32}
57     \textcolor{keywordtype}{char} path[256];
58     HMODULE hm = NULL;
59 
60     GetModuleHandleExA(GET\_MODULE\_HANDLE\_EX\_FLAG\_FROM\_ADDRESS | 
      GET\_MODULE\_HANDLE\_EX\_FLAG\_UNCHANGED\_REFCOUNT,
61                             (LPCSTR) &\hyperlink{utils_8cpp_aeb7eb5c2a751102d58ea3d7b15bd5bcf}{GetLocalModuleFilename}, &hm);
62 
63     GetModuleFileNameA(hm, path, \textcolor{keyword}{sizeof}(path));
64     \textcolor{keywordflow}{return} path;
65 \textcolor{preprocessor}{#else}
66 \textcolor{preprocessor}{    #error GetLocalModuleName() not implemented for this platform}
67 \textcolor{preprocessor}{#endif}
68 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Get\+Local\+Module\+Path@{Get\+Local\+Module\+Path}}
\index{Get\+Local\+Module\+Path@{Get\+Local\+Module\+Path}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Get\+Local\+Module\+Path()}{GetLocalModulePath()}}]{\setlength{\rightskip}{0pt plus 5cm}std\+::string Get\+Local\+Module\+Path (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_a94c5c46fa5ac0e27fa3f171b171fe8ae}{}\label{utils_8cpp_a94c5c46fa5ac0e27fa3f171b171fe8ae}

\begin{DoxyCode}
115 \{
116     std::string dllpath = \hyperlink{utils_8cpp_aeb7eb5c2a751102d58ea3d7b15bd5bcf}{GetLocalModuleFilename}();
117     \textcolor{keywordflow}{return} \hyperlink{utils_8cpp_abb79ff4e841148f46f68fed19d087169}{GetDirectoryFromPath}(dllpath);
118 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Get\+Precise\+Time@{Get\+Precise\+Time}}
\index{Get\+Precise\+Time@{Get\+Precise\+Time}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Get\+Precise\+Time()}{GetPreciseTime()}}]{\setlength{\rightskip}{0pt plus 5cm}double Get\+Precise\+Time (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_a11abc9edca3542dd4e74dadf99340fa1}{}\label{utils_8cpp_a11abc9edca3542dd4e74dadf99340fa1}

\begin{DoxyCode}
680 \{
681     uint64\_t freq, time;
682 
683     QueryPerformanceCounter((LARGE\_INTEGER*)&time);
684     QueryPerformanceFrequency((LARGE\_INTEGER*)&freq);
685 
686     \textcolor{keywordflow}{return} (\textcolor{keywordtype}{double})time / (double)freq;
687 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Nearest\+Power\+Of2@{Nearest\+Power\+Of2}}
\index{Nearest\+Power\+Of2@{Nearest\+Power\+Of2}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Nearest\+Power\+Of2(int v)}{NearestPowerOf2(int v)}}]{\setlength{\rightskip}{0pt plus 5cm}int Nearest\+Power\+Of2 (
\begin{DoxyParamCaption}
\item[{int}]{v}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_a93409977ae90735769d0d2f37b19604e}{}\label{utils_8cpp_a93409977ae90735769d0d2f37b19604e}

\begin{DoxyCode}
693 \{
694     \textcolor{keywordtype}{int} r=1;
695     \textcolor{keywordflow}{while} (r < v) 
696         r *= 2;
697     \textcolor{keywordflow}{if} ( fabsf(r-v) < fabsf(r/2-v) )
698         \textcolor{keywordflow}{return} r;
699     \textcolor{keywordflow}{return} r/2;
700 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Nearest\+Power\+Of3@{Nearest\+Power\+Of3}}
\index{Nearest\+Power\+Of3@{Nearest\+Power\+Of3}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Nearest\+Power\+Of3(int v)}{NearestPowerOf3(int v)}}]{\setlength{\rightskip}{0pt plus 5cm}int Nearest\+Power\+Of3 (
\begin{DoxyParamCaption}
\item[{int}]{v}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_a5f7925a9c145be917c154215435e26fc}{}\label{utils_8cpp_a5f7925a9c145be917c154215435e26fc}

\begin{DoxyCode}
703 \{
704     \textcolor{keywordtype}{int} r=1;
705     \textcolor{keywordflow}{while} (r < v) 
706         r *= 3;
707     \textcolor{keywordflow}{if} ( fabsf(r-v) < fabsf(r/3-v) )
708         \textcolor{keywordflow}{return} r;
709     \textcolor{keywordflow}{return} r/3;
710 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Normalize\+Radial\+Profile@{Normalize\+Radial\+Profile}}
\index{Normalize\+Radial\+Profile@{Normalize\+Radial\+Profile}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Normalize\+Radial\+Profile(scalar\+\_\+t $\ast$prof, int rsteps)}{NormalizeRadialProfile(scalar_t *prof, int rsteps)}}]{\setlength{\rightskip}{0pt plus 5cm}void Normalize\+Radial\+Profile (
\begin{DoxyParamCaption}
\item[{{\bf scalar\+\_\+t} $\ast$}]{prof, }
\item[{int}]{rsteps}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_a404fa660440d30ed70566aebf9f9e94a}{}\label{utils_8cpp_a404fa660440d30ed70566aebf9f9e94a}

\begin{DoxyCode}
260 \{
261     \textcolor{keywordtype}{double} sum=0.0f;
262     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<rsteps;i++)
263         sum += prof[i];
264 
265     \textcolor{keywordtype}{float} mean =sum/rsteps;
266     \textcolor{keywordtype}{double} rmssum2 = 0.0;
267 
268     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<rsteps;i++) \{
269         prof[i] -= mean;
270         rmssum2 += prof[i]*prof[i];
271     \}
272     \textcolor{keywordtype}{double} invTotalrms = 1.0f/\hyperlink{std__incl_8h_a8a38721046513951c4bfc32bf101e180}{sqrt}(rmssum2/rsteps);
273     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<rsteps;i++)
274         prof[i] *= invTotalrms;
275         
276 \textcolor{comment}{/*}
277 \textcolor{comment}{    scalar\_t minVal = prof[0];}
278 \textcolor{comment}{    for (int i=0;i<rsteps;i++)}
279 \textcolor{comment}{        if(prof[i]<minVal) minVal=prof[i]; }
280 \textcolor{comment}{}
281 \textcolor{comment}{    float rms=0;}
282 \textcolor{comment}{    for (int i=0;i<rsteps;i++) \{}
283 \textcolor{comment}{        prof[i]-=minVal;}
284 \textcolor{comment}{        rms += prof[i]*prof[i];}
285 \textcolor{comment}{    \}}
286 \textcolor{comment}{    rms=1.0f/sqrt(rms);}
287 \textcolor{comment}{    for (int i=0;i<rsteps;i++) \{}
288 \textcolor{comment}{        prof[i]*=rms;}
289 \textcolor{comment}{    \}*/}
290 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Normalize\+Z\+L\+UT@{Normalize\+Z\+L\+UT}}
\index{Normalize\+Z\+L\+UT@{Normalize\+Z\+L\+UT}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Normalize\+Z\+L\+U\+T(float $\ast$zlut, int num\+Beads, int planes, int radialsteps)}{NormalizeZLUT(float *zlut, int numBeads, int planes, int radialsteps)}}]{\setlength{\rightskip}{0pt plus 5cm}void Normalize\+Z\+L\+UT (
\begin{DoxyParamCaption}
\item[{float $\ast$}]{zlut, }
\item[{int}]{num\+Beads, }
\item[{int}]{planes, }
\item[{int}]{radialsteps}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_a394f1ad70cd62465e18850f87c93351c}{}\label{utils_8cpp_a394f1ad70cd62465e18850f87c93351c}

\begin{DoxyCode}
294 \{
295     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<numBeads;i++)
296         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0;j<planes;j++)
297             \hyperlink{utils_8cpp_a404fa660440d30ed70566aebf9f9e94a}{NormalizeRadialProfile}(&zlut[radialsteps*planes*i + radialsteps*j], 
      radialsteps);
298 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Read\+C\+SV@{Read\+C\+SV}}
\index{Read\+C\+SV@{Read\+C\+SV}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Read\+C\+S\+V(const char $\ast$filename, char sep)}{ReadCSV(const char *filename, char sep)}}]{\setlength{\rightskip}{0pt plus 5cm}std\+::vector$<$ std\+::vector$<$float$>$ $>$ Read\+C\+SV (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{filename, }
\item[{char}]{sep}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_a97c4edb27d72c98256ae9ba9d9a92145}{}\label{utils_8cpp_a97c4edb27d72c98256ae9ba9d9a92145}

\begin{DoxyCode}
468 \{
469     std::list< std::vector <float> > data;
470 
471     FILE *f=fopen(filename,\textcolor{stringliteral}{"r"});
472     \textcolor{keywordflow}{if} (f) \{
473         std::string buf;
474         std::vector<float> vals;
475         \textcolor{keywordflow}{while} (!feof(f)) \{
476             \textcolor{keywordtype}{char} c=fgetc(f);
477             \textcolor{keywordflow}{if} (c == sep || c==\textcolor{charliteral}{'\(\backslash\)n'}) \{
478                 vals.push\_back( atof(buf.c\_str()) );
479                 buf.clear();
480             \}
481             \textcolor{keywordflow}{if} (c == \textcolor{charliteral}{'\(\backslash\)n'}) \{
482                 data.push\_back( vals );
483                 vals.clear();
484             \}
485 
486             \textcolor{keywordflow}{if} (c != sep && c!= \textcolor{charliteral}{'\(\backslash\)n'})
487                 buf+=c;
488         \}
489         fclose(f);
490     \}
491     
492     std::vector<std::vector<float> > r;
493     r.reserve(data.size());
494     r.insert(r.begin(), data.begin(), data.end());
495     \textcolor{keywordflow}{return} r;
496 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Read\+J\+P\+E\+G\+File@{Read\+J\+P\+E\+G\+File}}
\index{Read\+J\+P\+E\+G\+File@{Read\+J\+P\+E\+G\+File}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Read\+J\+P\+E\+G\+File(const char $\ast$fn)}{ReadJPEGFile(const char *fn)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Image\+Data} Read\+J\+P\+E\+G\+File (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{fn}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_a9d2506602d1c5b6419101f13380ddb59}{}\label{utils_8cpp_a9d2506602d1c5b6419101f13380ddb59}

\begin{DoxyCode}
634 \{
635     \textcolor{keywordtype}{int} w, h;
636     \hyperlink{std__incl_8h_a65f85814a8290f9797005d3b28e7e5fc}{uchar}* imgdata;
637     std::vector<uchar> jpgdata = \hyperlink{utils_8cpp_afc3a35e21ebcc6c29a05f25c58c74157}{ReadToByteBuffer}(fn);
638     \hyperlink{utils_8cpp_a9d2506602d1c5b6419101f13380ddb59}{ReadJPEGFile}(&jpgdata[0], jpgdata.size(), &imgdata, &w,&h);
639 
640     \textcolor{keywordtype}{float}* fbuf = \textcolor{keyword}{new} \textcolor{keywordtype}{float}[w*h];
641     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x=0;x<w*h;x++)
642         fbuf[x] = imgdata[x]/255.0f;
643     \textcolor{keyword}{delete}[] imgdata;
644 
645     \textcolor{keywordflow}{return} \hyperlink{_queued_tracker_8h_a2d6726594ce64e82b9222b183f2571d1}{ImageData}(fbuf,w,h);
646 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Read\+L\+U\+T\+File@{Read\+L\+U\+T\+File}}
\index{Read\+L\+U\+T\+File@{Read\+L\+U\+T\+File}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Read\+L\+U\+T\+File(const char $\ast$lutfile)}{ReadLUTFile(const char *lutfile)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Image\+Data} Read\+L\+U\+T\+File (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{lutfile}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_afa12308b716c890001e2b072f45d4a74}{}\label{utils_8cpp_afa12308b716c890001e2b072f45d4a74}

\begin{DoxyCode}
729 \{
730     \hyperlink{struct_path_seperator}{PathSeperator} sep(lutfile);
731     \textcolor{keywordflow}{if}(sep.extension == \textcolor{stringliteral}{"jpg"}) \{
732         \textcolor{keywordflow}{return} \hyperlink{utils_8cpp_a9d2506602d1c5b6419101f13380ddb59}{ReadJPEGFile}(lutfile);
733     \}
734     \textcolor{keywordflow}{else} \{
735         std::string fn = lutfile;
736         fn = std::string(fn.begin(), fn.begin()+fn.find(\textcolor{charliteral}{'#'}));
737         std::string num( ++( sep.extension.begin() + sep.extension.find(\textcolor{charliteral}{'#'}) ), sep.extension.end());
738         \textcolor{keywordtype}{int} lutIndex = atoi(num.c\_str());
739 
740         \textcolor{keywordtype}{int} nbeads, nplanes, nsteps;
741         FILE *f = fopen(fn.c\_str(), \textcolor{stringliteral}{"rb"});
742 
743         \textcolor{keywordflow}{if} (!f)
744             \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"Can't open "} + fn);
745 
746         fread(&nbeads, 4, 1, f);
747         fread(&nplanes, 4, 1, f);
748         fread(&nsteps, 4, 1, f);
749 
750 
751         fseek(f, 12 + 4* (nsteps*nplanes * lutIndex), SEEK\_SET);
752         \hyperlink{struct_t_image_data}{ImageData} lut = \hyperlink{struct_t_image_data_a8ae528964e70c0d0a98b8481cc8b083e}{ImageData::alloc}(nsteps,nplanes);
753         fread(lut.\hyperlink{struct_t_image_data_a78c7415ecee3965da7e25149cea6f4d8}{data}, 4, nsteps*nplanes,f);
754         fclose(f);
755         lut.\hyperlink{struct_t_image_data_ac987182fb87787d7d274a30cf4a198d4}{normalize}();
756         \textcolor{keywordflow}{return} lut;
757     \}
758 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Read\+To\+Byte\+Buffer@{Read\+To\+Byte\+Buffer}}
\index{Read\+To\+Byte\+Buffer@{Read\+To\+Byte\+Buffer}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Read\+To\+Byte\+Buffer(const char $\ast$filename)}{ReadToByteBuffer(const char *filename)}}]{\setlength{\rightskip}{0pt plus 5cm}std\+::vector$<${\bf uchar}$>$ Read\+To\+Byte\+Buffer (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{filename}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_afc3a35e21ebcc6c29a05f25c58c74157}{}\label{utils_8cpp_afc3a35e21ebcc6c29a05f25c58c74157}

\begin{DoxyCode}
615 \{
616     FILE *f = fopen(filename, \textcolor{stringliteral}{"rb"});
617 
618     \textcolor{keywordflow}{if} (!f)
619         \textcolor{keywordflow}{throw} std::runtime\_error(\hyperlink{utils_8cpp_aba26a6b64035ef7962a63b760dd9013e}{SPrintf}(\textcolor{stringliteral}{"%s was not found"}, filename));
620 
621     fseek(f, 0, SEEK\_END);
622     \textcolor{keywordtype}{int} len = ftell(f);
623     fseek(f, 0, SEEK\_SET);
624 
625     std::vector<uchar> buf(len);
626     fread(&buf[0], 1,len, f);
627 
628     fclose(f);
629     \textcolor{keywordflow}{return} buf;
630 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Read\+Vector3\+C\+SV@{Read\+Vector3\+C\+SV}}
\index{Read\+Vector3\+C\+SV@{Read\+Vector3\+C\+SV}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Read\+Vector3\+C\+S\+V(const char $\ast$file, char sep)}{ReadVector3CSV(const char *file, char sep)}}]{\setlength{\rightskip}{0pt plus 5cm}std\+::vector$<${\bf vector3f}$>$ Read\+Vector3\+C\+SV (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{file, }
\item[{char}]{sep}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_abc30341e16799156a1b3b6093ea7d3d5}{}\label{utils_8cpp_abc30341e16799156a1b3b6093ea7d3d5}

\begin{DoxyCode}
500 \{
501     \textcolor{keyword}{auto} data=\hyperlink{utils_8cpp_a97c4edb27d72c98256ae9ba9d9a92145}{ReadCSV}(file ,sep);
502 
503     std::vector<vector3f> r(data.size());
504 
505     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<data.size();i++)\{
506         r[i]=\hyperlink{std__incl_8h_a2feaef1d85a74bd5cf80df91b1a9a914}{vector3f}(data[i][0],data[i][1],data[i][2]);
507     \}
508     \textcolor{keywordflow}{return} r;
509 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!S\+Printf@{S\+Printf}}
\index{S\+Printf@{S\+Printf}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{S\+Printf(const char $\ast$fmt,...)}{SPrintf(const char *fmt,...)}}]{\setlength{\rightskip}{0pt plus 5cm}std\+::string S\+Printf (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{fmt, }
\item[{}]{...}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_aba26a6b64035ef7962a63b760dd9013e}{}\label{utils_8cpp_aba26a6b64035ef7962a63b760dd9013e}

\begin{DoxyCode}
132                                         \{
133     va\_list ap;
134     va\_start(ap, fmt);
135 
136     \textcolor{keywordtype}{char} buf[512];
137     \hyperlink{std__incl_8h_ac2e4f48c3da557e8b268aee96009e135}{VSNPRINTF}(buf, \textcolor{keyword}{sizeof}(buf), fmt, ap);
138 
139     va\_end(ap);
140     \textcolor{keywordflow}{return} buf;
141 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!sq@{sq}}
\index{sq@{sq}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{sq(float x)}{sq(float x)}}]{\setlength{\rightskip}{0pt plus 5cm}float sq (
\begin{DoxyParamCaption}
\item[{float}]{x}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{utils_8cpp_a5d9a285a9ed595c633d5fc06e622df8f}{}\label{utils_8cpp_a5d9a285a9ed595c633d5fc06e622df8f}

\begin{DoxyCode}
355 \{ \textcolor{keywordflow}{return} x*x; \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Write\+Array\+As\+C\+S\+V\+Row@{Write\+Array\+As\+C\+S\+V\+Row}}
\index{Write\+Array\+As\+C\+S\+V\+Row@{Write\+Array\+As\+C\+S\+V\+Row}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Write\+Array\+As\+C\+S\+V\+Row(const char $\ast$file, float $\ast$d, int len, bool append)}{WriteArrayAsCSVRow(const char *file, float *d, int len, bool append)}}]{\setlength{\rightskip}{0pt plus 5cm}void Write\+Array\+As\+C\+S\+V\+Row (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{file, }
\item[{float $\ast$}]{d, }
\item[{int}]{len, }
\item[{bool}]{append}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_aa0fb8da4922e3042928ed9f6388bc09a}{}\label{utils_8cpp_aa0fb8da4922e3042928ed9f6388bc09a}

\begin{DoxyCode}
543 \{
544     FILE *f = fopen(file, append?\textcolor{stringliteral}{"a"}:\textcolor{stringliteral}{"w"});
545     \textcolor{keywordflow}{if}(f) \{
546         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<len;i++)
547             fprintf(f, \textcolor{stringliteral}{"%.7f\(\backslash\)t"}, d[i]);
548 
549         fprintf(f, \textcolor{stringliteral}{"\(\backslash\)n"});
550         fclose(f);
551     \}
552     \textcolor{keywordflow}{else}
553         \hyperlink{utils_8cpp_a4a7132c90e490d24edecb391a754a9c0}{dbgprintf}(\textcolor{stringliteral}{"WriteArrayAsCSVRow: Unable to open file %s\(\backslash\)n"}, file);
554 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Write\+Complex\+Image\+As\+C\+SV@{Write\+Complex\+Image\+As\+C\+SV}}
\index{Write\+Complex\+Image\+As\+C\+SV@{Write\+Complex\+Image\+As\+C\+SV}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Write\+Complex\+Image\+As\+C\+S\+V(const char $\ast$file, std\+::complex$<$ float $>$ $\ast$d, int w, int h, const char $\ast$labels[])}{WriteComplexImageAsCSV(const char *file, std::complex< float > *d, int w, int h, const char *labels[])}}]{\setlength{\rightskip}{0pt plus 5cm}void Write\+Complex\+Image\+As\+C\+SV (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{file, }
\item[{std\+::complex$<$ float $>$ $\ast$}]{d, }
\item[{int}]{w, }
\item[{int}]{h, }
\item[{const char $\ast$}]{labels\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_a1a1189014022a9f0fe2333757512155a}{}\label{utils_8cpp_a1a1189014022a9f0fe2333757512155a}

\begin{DoxyCode}
586 \{
587     FILE* f = fopen(file, \textcolor{stringliteral}{"w"});
588 
589     \textcolor{keywordflow}{if} (!f) \{
590         \hyperlink{utils_8cpp_a4a7132c90e490d24edecb391a754a9c0}{dbgprintf}(\textcolor{stringliteral}{"WriteComplexImageAsCSV: Unable to open file %s\(\backslash\)n"}, file);
591         \textcolor{keywordflow}{return};
592     \}
593 
594     \textcolor{keywordflow}{if} (labels) \{
595         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<w;i++) \{
596             fprintf(f, \textcolor{stringliteral}{"%s;\(\backslash\)t"}, labels[i]);
597         \}
598         fputs(\textcolor{stringliteral}{"\(\backslash\)n"}, f);
599     \}
600 
601     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y=0;y<h;y++) \{
602         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x=0;x<w;x++)
603         \{
604             \textcolor{keywordtype}{float} i=d[y*w+x].imag();
605             fprintf(f, \textcolor{stringliteral}{"%f%+fi"}, d[y*w+x].real(), i);
606             \textcolor{keywordflow}{if}(x<w-1) fputs(\textcolor{stringliteral}{"\(\backslash\)t"}, f); 
607         \}
608         fprintf(f, \textcolor{stringliteral}{"\(\backslash\)n"});
609     \}
610 
611     fclose(f);
612 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Write\+Image\+As\+C\+SV@{Write\+Image\+As\+C\+SV}}
\index{Write\+Image\+As\+C\+SV@{Write\+Image\+As\+C\+SV}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Write\+Image\+As\+C\+S\+V(const char $\ast$file, float $\ast$d, int w, int h, const char $\ast$labels[])}{WriteImageAsCSV(const char *file, float *d, int w, int h, const char *labels[])}}]{\setlength{\rightskip}{0pt plus 5cm}void Write\+Image\+As\+C\+SV (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{file, }
\item[{float $\ast$}]{d, }
\item[{int}]{w, }
\item[{int}]{h, }
\item[{const char $\ast$}]{labels\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_ad594d63fab5898e75c6eeb533368aba8}{}\label{utils_8cpp_ad594d63fab5898e75c6eeb533368aba8}

\begin{DoxyCode}
557 \{
558     FILE* f = fopen(file, \textcolor{stringliteral}{"w"});
559 
560     \textcolor{keywordflow}{if} (f) \{
561 
562         \textcolor{keywordflow}{if} (labels) \{
563             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<w;i++) \{
564                 fprintf(f, \textcolor{stringliteral}{"%s;\(\backslash\)t"}, labels[i]);
565             \}
566             fputs(\textcolor{stringliteral}{"\(\backslash\)n"}, f);
567         \}
568 
569         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y=0;y<h;y++) \{
570             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x=0;x<w;x++)
571             \{
572                 fprintf(f, \textcolor{stringliteral}{"%.10f"}, d[y*w+x]);
573                 \textcolor{keywordflow}{if}(x<w-1) fputs(\textcolor{stringliteral}{"\(\backslash\)t"}, f); 
574             \}
575             fprintf(f, \textcolor{stringliteral}{"\(\backslash\)n"});
576         \}
577 
578         fclose(f);
579     \}
580     \textcolor{keywordflow}{else}
581         \hyperlink{utils_8cpp_a4a7132c90e490d24edecb391a754a9c0}{dbgprintf}(\textcolor{stringliteral}{"WriteImageAsCSV: Unable to open file %s\(\backslash\)n"}, file);
582 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Write\+To\+Log@{Write\+To\+Log}}
\index{Write\+To\+Log@{Write\+To\+Log}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Write\+To\+Log(const char $\ast$str)}{WriteToLog(const char *str)}}]{\setlength{\rightskip}{0pt plus 5cm}void Write\+To\+Log (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{str}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_a573f566a9717a199b5311d89e75aa010}{}\label{utils_8cpp_a573f566a9717a199b5311d89e75aa010}

\begin{DoxyCode}
89 \{
90     \textcolor{keywordflow}{if} (\hyperlink{utils_8cpp_ae003eabff7038472981e17852dc6aa82}{logFilename}.empty()) \{
91         \textcolor{keyword}{auto} ps = \hyperlink{struct_path_seperator}{PathSeperator}(\hyperlink{utils_8cpp_aeb7eb5c2a751102d58ea3d7b15bd5bcf}{GetLocalModuleFilename}());
92         \hyperlink{utils_8cpp_ae003eabff7038472981e17852dc6aa82}{logFilename} = ps.directory + ps.filename + \textcolor{stringliteral}{"-log.txt"};
93     \}
94 
95     \textcolor{keywordflow}{if} (str) \{
96         FILE* f = fopen(\hyperlink{utils_8cpp_ae003eabff7038472981e17852dc6aa82}{logFilename}.c\_str(), \textcolor{stringliteral}{"a"});
97         \textcolor{keywordflow}{if} (f) \{
98             fputs(str,f);
99             fclose(f);
100         \}
101     \}
102 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Write\+Trace@{Write\+Trace}}
\index{Write\+Trace@{Write\+Trace}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Write\+Trace(std\+::string filename, vector3f $\ast$results, int n\+Results)}{WriteTrace(std::string filename, vector3f *results, int nResults)}}]{\setlength{\rightskip}{0pt plus 5cm}void Write\+Trace (
\begin{DoxyParamCaption}
\item[{std\+::string}]{filename, }
\item[{{\bf vector3f} $\ast$}]{results, }
\item[{int}]{n\+Results}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_ac53dbc16bbb47e927b088892e806dcf7}{}\label{utils_8cpp_ac53dbc16bbb47e927b088892e806dcf7}

\begin{DoxyCode}
513 \{
514     FILE *f = fopen(filename.c\_str(), \textcolor{stringliteral}{"w"});
515 
516     \textcolor{keywordflow}{if} (!f) \{
517         \textcolor{keywordflow}{throw} std::runtime\_error(\hyperlink{utils_8cpp_aba26a6b64035ef7962a63b760dd9013e}{SPrintf}(\textcolor{stringliteral}{"Can't open %s"}, filename.c\_str()));
518     \}
519 
520     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<nResults;i++)
521     \{
522         fprintf(f, \textcolor{stringliteral}{"%.7f\(\backslash\)t%.7f\(\backslash\)t%.7f\(\backslash\)n"}, results[i].x, results[i].y, results[i].z);
523     \}
524 
525     fclose(f);
526 \}
\end{DoxyCode}
\index{utils.\+cpp@{utils.\+cpp}!Write\+Vector\+As\+C\+S\+V\+Row@{Write\+Vector\+As\+C\+S\+V\+Row}}
\index{Write\+Vector\+As\+C\+S\+V\+Row@{Write\+Vector\+As\+C\+S\+V\+Row}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{Write\+Vector\+As\+C\+S\+V\+Row(const char $\ast$file, std\+::vector$<$ float $>$ d, bool append)}{WriteVectorAsCSVRow(const char *file, std::vector< float > d, bool append)}}]{\setlength{\rightskip}{0pt plus 5cm}void Write\+Vector\+As\+C\+S\+V\+Row (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{file, }
\item[{std\+::vector$<$ float $>$}]{d, }
\item[{bool}]{append}
\end{DoxyParamCaption}
)}\hypertarget{utils_8cpp_aeb2d139686549bd29fe86f72247eecf1}{}\label{utils_8cpp_aeb2d139686549bd29fe86f72247eecf1}

\begin{DoxyCode}
529 \{
530     FILE *f = fopen(file, append?\textcolor{stringliteral}{"a"}:\textcolor{stringliteral}{"w"});
531     \textcolor{keywordflow}{if}(f) \{
532         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<d.size();i++)
533             fprintf(f, \textcolor{stringliteral}{"%1.7f\(\backslash\)t"}, d[i]);
534 
535         fprintf(f, \textcolor{stringliteral}{"\(\backslash\)n"});
536         fclose(f);
537     \}
538     \textcolor{keywordflow}{else}
539         \hyperlink{utils_8cpp_a4a7132c90e490d24edecb391a754a9c0}{dbgprintf}(\textcolor{stringliteral}{"WriteArrayAsCSVRow: Unable to open file %s\(\backslash\)n"}, file);
540 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\index{utils.\+cpp@{utils.\+cpp}!log\+Filename@{log\+Filename}}
\index{log\+Filename@{log\+Filename}!utils.\+cpp@{utils.\+cpp}}
\subsubsection[{\texorpdfstring{log\+Filename}{logFilename}}]{\setlength{\rightskip}{0pt plus 5cm}std\+::string log\+Filename\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{utils_8cpp_ae003eabff7038472981e17852dc6aa82}{}\label{utils_8cpp_ae003eabff7038472981e17852dc6aa82}
