\hypertarget{struct_image4_d_cuda_array}{}\section{Image4\+D\+Cuda\+Array$<$ T $>$ Struct Template Reference}
\label{struct_image4_d_cuda_array}\index{Image4\+D\+Cuda\+Array$<$ T $>$@{Image4\+D\+Cuda\+Array$<$ T $>$}}


{\ttfamily \#include $<$cuda\+Image\+List.\+h$>$}

\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{struct_image4_d_cuda_array_1_1_kernel_inst}{Kernel\+Inst}
\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
cuda\+Extent \hyperlink{struct_image4_d_cuda_array_a69a6e1459f05922d781b583e29fe07ca}{get\+Extent} ()
\item 
\hyperlink{struct_image4_d_cuda_array_1_1_kernel_inst}{Kernel\+Inst} \hyperlink{struct_image4_d_cuda_array_ab815a1a7c5a56396a1582845096d5ba4}{kernel\+Inst} ()
\item 
void \hyperlink{struct_image4_d_cuda_array_a335cc167d5fa7cfb2d54f02dabe49582}{bind} (texture$<$ T, cuda\+Texture\+Type2\+D\+Layered, cuda\+Read\+Mode\+Element\+Type $>$ \&texref)
\item 
void \hyperlink{struct_image4_d_cuda_array_a48bf8bb27196030387c6047cb6b7c323}{unbind} (texture$<$ T, cuda\+Texture\+Type2\+D\+Layered, cuda\+Read\+Mode\+Element\+Type $>$ \&texref)
\item 
void \hyperlink{struct_image4_d_cuda_array_a465db4fbb5e7019f3327aa1a2a5b8251}{bind} (surface$<$ void, cuda\+Surface\+Type2\+D\+Layered $>$ \&surf)
\item 
\hyperlink{struct_image4_d_cuda_array_a111e6a02aa56ecac3edb020a7628f38f}{Image4\+D\+Cuda\+Array} (int sx, int sy, int \hyperlink{struct_image4_d_cuda_array_acc1ba710635bc84af3d3032b7a38dea3}{num\+Img}, int sL)
\item 
int2 \hyperlink{struct_image4_d_cuda_array_a24b592522dd8418266cfb434cc09f40e}{get\+Image\+Pos} (int image)
\item 
\hyperlink{struct_image4_d_cuda_array_a217d7dd1db0434b6ec0e41c9b1723a89}{$\sim$\+Image4\+D\+Cuda\+Array} ()
\item 
void \hyperlink{struct_image4_d_cuda_array_a3cff003804ea5cdcc1fad578726a004b}{copy\+To\+Device} (T $\ast$src, bool async=false, cuda\+Stream\+\_\+t s=0)
\item 
void \hyperlink{struct_image4_d_cuda_array_a5f91354c4b6bffdfaea64d2feb078f81}{copy\+To\+Host} (T $\ast$dst, bool async=false, cuda\+Stream\+\_\+t s=0)
\item 
void \hyperlink{struct_image4_d_cuda_array_a7157ddd0e5a243d4692672fa0f5ac360}{clear} ()
\item 
void \hyperlink{struct_image4_d_cuda_array_ae5163e1758111d003633823d9af387f8}{copy\+Image\+To\+Host} (int img, int layer, T $\ast$dst, bool async=false, cuda\+Stream\+\_\+t s=0)
\item 
void \hyperlink{struct_image4_d_cuda_array_aed4f5c8cc5bda9d267b99757cbb23f80}{copy\+Image\+To\+Device} (int img, int layer, T $\ast$src, bool async=false, cuda\+Stream\+\_\+t s=0)
\item 
void \hyperlink{struct_image4_d_cuda_array_a57f7d708e0ecbbfd96be7ebce94200e0}{free} ()
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
cuda\+Array\+\_\+t \hyperlink{struct_image4_d_cuda_array_a4043697cb965dc8bd3dbc33f3840dd92}{array}
\item 
int \hyperlink{struct_image4_d_cuda_array_a7f23302d874ffff216e49e33e9b5ca41}{imgw}
\item 
int \hyperlink{struct_image4_d_cuda_array_abdb9e7f88b589af46a4cf0b543ecac9b}{imgh}
\item 
int \hyperlink{struct_image4_d_cuda_array_aef314c7da09f67d8095bfb93a5102906}{layerw}
\item 
int \hyperlink{struct_image4_d_cuda_array_a1fd2bc8556d6c750f67799dacad099a4}{layerh}
\item 
int \hyperlink{struct_image4_d_cuda_array_a2cc68c6d8492e7a0d2fa194cc3a58187}{nlayers}
\item 
int \hyperlink{struct_image4_d_cuda_array_acc1ba710635bc84af3d3032b7a38dea3}{num\+Img}
\end{DoxyCompactItemize}


\subsection{Constructor \& Destructor Documentation}
\index{Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}!Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}}
\index{Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}!Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}}
\subsubsection[{\texorpdfstring{Image4\+D\+Cuda\+Array(int sx, int sy, int num\+Img, int s\+L)}{Image4DCudaArray(int sx, int sy, int numImg, int sL)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ {\bf Image4\+D\+Cuda\+Array}$<$ T $>$\+::{\bf Image4\+D\+Cuda\+Array} (
\begin{DoxyParamCaption}
\item[{int}]{sx, }
\item[{int}]{sy, }
\item[{int}]{num\+Img, }
\item[{int}]{sL}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{struct_image4_d_cuda_array_a111e6a02aa56ecac3edb020a7628f38f}{}\label{struct_image4_d_cuda_array_a111e6a02aa56ecac3edb020a7628f38f}

\begin{DoxyCode}
271                                                           \{
272         \hyperlink{struct_image4_d_cuda_array_a4043697cb965dc8bd3dbc33f3840dd92}{array} = 0;
273         \textcolor{keywordtype}{int} d;
274         cudaGetDevice(&d);
275         cudaDeviceProp prop;
276         cudaGetDeviceProperties(&prop, d);
277         
278         \hyperlink{struct_image4_d_cuda_array_a7f23302d874ffff216e49e33e9b5ca41}{imgw} = sx;
279         \hyperlink{struct_image4_d_cuda_array_abdb9e7f88b589af46a4cf0b543ecac9b}{imgh} = sy;
280         this->\hyperlink{struct_image4_d_cuda_array_acc1ba710635bc84af3d3032b7a38dea3}{numImg} = \hyperlink{struct_image4_d_cuda_array_acc1ba710635bc84af3d3032b7a38dea3}{numImg};
281 
282 \textcolor{comment}{//      layerh = (int)(prop.maxSurface2DLayered[1] / imgh);}
283         \hyperlink{struct_image4_d_cuda_array_a1fd2bc8556d6c750f67799dacad099a4}{layerh} = 2048 / \hyperlink{struct_image4_d_cuda_array_abdb9e7f88b589af46a4cf0b543ecac9b}{imgh};
284         \hyperlink{struct_image4_d_cuda_array_aef314c7da09f67d8095bfb93a5102906}{layerw} = (\hyperlink{struct_image4_d_cuda_array_acc1ba710635bc84af3d3032b7a38dea3}{numImg} + \hyperlink{struct_image4_d_cuda_array_a1fd2bc8556d6c750f67799dacad099a4}{layerh} - 1) / \hyperlink{struct_image4_d_cuda_array_a1fd2bc8556d6c750f67799dacad099a4}{layerh};
285         \hyperlink{struct_image4_d_cuda_array_a2cc68c6d8492e7a0d2fa194cc3a58187}{nlayers} = sL;
286 
287         \hyperlink{utils_8cpp_a4a7132c90e490d24edecb391a754a9c0}{dbgprintf}(\textcolor{stringliteral}{"creating image4D: %d layers of %d x %d images of %d x %d (%dx%dx%d)\(\backslash\)n"}, 
288             sL, \hyperlink{struct_image4_d_cuda_array_aef314c7da09f67d8095bfb93a5102906}{layerw}, \hyperlink{struct_image4_d_cuda_array_a1fd2bc8556d6c750f67799dacad099a4}{layerh}, \hyperlink{struct_image4_d_cuda_array_a7f23302d874ffff216e49e33e9b5ca41}{imgw}, \hyperlink{struct_image4_d_cuda_array_abdb9e7f88b589af46a4cf0b543ecac9b}{imgh}, \hyperlink{struct_image4_d_cuda_array_a69a6e1459f05922d781b583e29fe07ca}{getExtent}().width,
      \hyperlink{struct_image4_d_cuda_array_a69a6e1459f05922d781b583e29fe07ca}{getExtent}().height,\hyperlink{struct_image4_d_cuda_array_a69a6e1459f05922d781b583e29fe07ca}{getExtent}().depth);
289 
290         cudaChannelFormatDesc desc = cudaCreateChannelDesc<T>();
291         cudaError\_t err = cudaMalloc3DArray(&\hyperlink{struct_image4_d_cuda_array_a4043697cb965dc8bd3dbc33f3840dd92}{array}, &desc, \hyperlink{struct_image4_d_cuda_array_a69a6e1459f05922d781b583e29fe07ca}{getExtent}(), cudaArrayLayered | 
      cudaArraySurfaceLoadStore);
292         \textcolor{comment}{//cudaError\_t err = cudaMalloc3DArray(&array, &desc, getExtent(), cudaArraySurfaceLoadStore);}
293         \textcolor{keywordflow}{if} (err != cudaSuccess) \{
294             \textcolor{keywordflow}{throw} std::bad\_alloc(\hyperlink{utils_8cpp_aba26a6b64035ef7962a63b760dd9013e}{SPrintf}(\textcolor{stringliteral}{"CUDA error during cudaSurf2DList(): %s"}, 
      cudaGetErrorString(err)).c\_str());
295         \}
296     \}
\end{DoxyCode}
\index{Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}!````~Image4\+D\+Cuda\+Array@{$\sim$\+Image4\+D\+Cuda\+Array}}
\index{````~Image4\+D\+Cuda\+Array@{$\sim$\+Image4\+D\+Cuda\+Array}!Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}}
\subsubsection[{\texorpdfstring{$\sim$\+Image4\+D\+Cuda\+Array()}{~Image4DCudaArray()}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ {\bf Image4\+D\+Cuda\+Array}$<$ T $>$\+::$\sim${\bf Image4\+D\+Cuda\+Array} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{struct_image4_d_cuda_array_a217d7dd1db0434b6ec0e41c9b1723a89}{}\label{struct_image4_d_cuda_array_a217d7dd1db0434b6ec0e41c9b1723a89}

\begin{DoxyCode}
303                         \{
304         \hyperlink{struct_image4_d_cuda_array_a57f7d708e0ecbbfd96be7ebce94200e0}{free}();
305     \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\index{Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}!bind@{bind}}
\index{bind@{bind}!Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}}
\subsubsection[{\texorpdfstring{bind(texture$<$ T, cuda\+Texture\+Type2\+D\+Layered, cuda\+Read\+Mode\+Element\+Type $>$ \&texref)}{bind(texture< T, cudaTextureType2DLayered, cudaReadModeElementType > &texref)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ void {\bf Image4\+D\+Cuda\+Array}$<$ T $>$\+::bind (
\begin{DoxyParamCaption}
\item[{texture$<$ T, cuda\+Texture\+Type2\+D\+Layered, cuda\+Read\+Mode\+Element\+Type $>$ \&}]{texref}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{struct_image4_d_cuda_array_a335cc167d5fa7cfb2d54f02dabe49582}{}\label{struct_image4_d_cuda_array_a335cc167d5fa7cfb2d54f02dabe49582}

\begin{DoxyCode}
256                                                                                      \{
257         cudaChannelFormatDesc desc = cudaCreateChannelDesc<T>();
258         \hyperlink{gpu__utils_8h_ae6b059a7637782d61577e695c9d6303e}{CheckCUDAError}( cudaBindTextureToArray(texref, \hyperlink{struct_image4_d_cuda_array_a4043697cb965dc8bd3dbc33f3840dd92}{array}, &desc) );
259     \}
\end{DoxyCode}
\index{Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}!bind@{bind}}
\index{bind@{bind}!Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}}
\subsubsection[{\texorpdfstring{bind(surface$<$ void, cuda\+Surface\+Type2\+D\+Layered $>$ \&surf)}{bind(surface< void, cudaSurfaceType2DLayered > &surf)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ void {\bf Image4\+D\+Cuda\+Array}$<$ T $>$\+::bind (
\begin{DoxyParamCaption}
\item[{surface$<$ void, cuda\+Surface\+Type2\+D\+Layered $>$ \&}]{surf}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{struct_image4_d_cuda_array_a465db4fbb5e7019f3327aa1a2a5b8251}{}\label{struct_image4_d_cuda_array_a465db4fbb5e7019f3327aa1a2a5b8251}

\begin{DoxyCode}
264                                                              \{
265         cudaChannelFormatDesc desc = cudaCreateChannelDesc<T>();
266         \hyperlink{gpu__utils_8h_ae6b059a7637782d61577e695c9d6303e}{CheckCUDAError}( cudaBindSurfaceToArray(surf, \hyperlink{struct_image4_d_cuda_array_a4043697cb965dc8bd3dbc33f3840dd92}{array}) );
267     \}
\end{DoxyCode}
\index{Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}!clear@{clear}}
\index{clear@{clear}!Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}}
\subsubsection[{\texorpdfstring{clear()}{clear()}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ void {\bf Image4\+D\+Cuda\+Array}$<$ T $>$\+::clear (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{struct_image4_d_cuda_array_a7157ddd0e5a243d4692672fa0f5ac360}{}\label{struct_image4_d_cuda_array_a7157ddd0e5a243d4692672fa0f5ac360}

\begin{DoxyCode}
324     \{
325         \textcolor{comment}{// create a new black image in device memory and use to it clear all the layers}
326         T* d;
327         \textcolor{keywordtype}{size\_t} srcpitch;
328         \hyperlink{gpu__utils_8h_ae6b059a7637782d61577e695c9d6303e}{CheckCUDAError}( cudaMallocPitch(&d, &srcpitch, \textcolor{keyword}{sizeof}(T)*
      \hyperlink{struct_image4_d_cuda_array_a7f23302d874ffff216e49e33e9b5ca41}{imgw}, \hyperlink{struct_image4_d_cuda_array_abdb9e7f88b589af46a4cf0b543ecac9b}{imgh}) );
329         \hyperlink{gpu__utils_8h_ae6b059a7637782d61577e695c9d6303e}{CheckCUDAError}( cudaMemset2D(d, srcpitch, 0, \textcolor{keyword}{sizeof}(T)*
      \hyperlink{struct_image4_d_cuda_array_a7f23302d874ffff216e49e33e9b5ca41}{imgw}, \hyperlink{struct_image4_d_cuda_array_abdb9e7f88b589af46a4cf0b543ecac9b}{imgh}) );
330 
331         cudaMemcpy3DParms p = \{0\};
332         p.dstArray = \hyperlink{struct_image4_d_cuda_array_a4043697cb965dc8bd3dbc33f3840dd92}{array};
333         p.extent = make\_cudaExtent(\hyperlink{struct_image4_d_cuda_array_a7f23302d874ffff216e49e33e9b5ca41}{imgw},\hyperlink{struct_image4_d_cuda_array_abdb9e7f88b589af46a4cf0b543ecac9b}{imgh},1);
334         p.kind = cudaMemcpyDeviceToDevice;
335         p.srcPtr = make\_cudaPitchedPtr(d, srcpitch, \textcolor{keyword}{sizeof}(T)*\hyperlink{struct_image4_d_cuda_array_a7f23302d874ffff216e49e33e9b5ca41}{imgw}, \hyperlink{struct_image4_d_cuda_array_abdb9e7f88b589af46a4cf0b543ecac9b}{imgh});
336         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} l=0;l<\hyperlink{struct_image4_d_cuda_array_a2cc68c6d8492e7a0d2fa194cc3a58187}{nlayers};l++)
337             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} img=0;img<\hyperlink{struct_image4_d_cuda_array_acc1ba710635bc84af3d3032b7a38dea3}{numImg};img++) \{
338                 int2 imgpos = \hyperlink{struct_image4_d_cuda_array_a24b592522dd8418266cfb434cc09f40e}{getImagePos}(img);
339                 p.dstPos.z = l;
340                 p.dstPos.x = imgpos.x;
341                 p.dstPos.y = imgpos.y;
342                 \hyperlink{gpu__utils_8h_ae6b059a7637782d61577e695c9d6303e}{CheckCUDAError}( cudaMemcpy3D(&p) );
343             \}
344         \hyperlink{gpu__utils_8h_ae6b059a7637782d61577e695c9d6303e}{CheckCUDAError}( cudaFree(d) );
345     \}
\end{DoxyCode}
\index{Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}!copy\+Image\+To\+Device@{copy\+Image\+To\+Device}}
\index{copy\+Image\+To\+Device@{copy\+Image\+To\+Device}!Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}}
\subsubsection[{\texorpdfstring{copy\+Image\+To\+Device(int img, int layer, T $\ast$src, bool async=false, cuda\+Stream\+\_\+t s=0)}{copyImageToDevice(int img, int layer, T *src, bool async=false, cudaStream_t s=0)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ void {\bf Image4\+D\+Cuda\+Array}$<$ T $>$\+::copy\+Image\+To\+Device (
\begin{DoxyParamCaption}
\item[{int}]{img, }
\item[{int}]{layer, }
\item[{T $\ast$}]{src, }
\item[{bool}]{async = {\ttfamily false}, }
\item[{cuda\+Stream\+\_\+t}]{s = {\ttfamily 0}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{struct_image4_d_cuda_array_aed4f5c8cc5bda9d267b99757cbb23f80}{}\label{struct_image4_d_cuda_array_aed4f5c8cc5bda9d267b99757cbb23f80}

\begin{DoxyCode}
371     \{
372         \textcolor{comment}{// Memcpy3D needs the right pitch for the source, so we first need to copy it to 2D pitched memory
       before moving the data to the cuda array}
373 \textcolor{comment}{//      cudaMallocPitch(}
374 
375         cudaMemcpy3DParms p = \{0\};
376         p.dstArray = \hyperlink{struct_image4_d_cuda_array_a4043697cb965dc8bd3dbc33f3840dd92}{array};
377         int2 imgpos = \hyperlink{struct_image4_d_cuda_array_a24b592522dd8418266cfb434cc09f40e}{getImagePos}(img);
378 
379         \textcolor{comment}{//The srcPos and dstPos fields are optional offsets into the source and destination objects and are
       defined in units of each object's elements. }
380         \textcolor{comment}{// The element for a host or device pointer is assumed to be unsigned char. For CUDA arrays,
       positions must be in the range [0, 2048) for any dimension. }
381         p.dstPos.z = layer;
382         p.dstPos.x = imgpos.x;
383         p.dstPos.y = imgpos.y;
384         p.extent = make\_cudaExtent(\hyperlink{struct_image4_d_cuda_array_a7f23302d874ffff216e49e33e9b5ca41}{imgw},\hyperlink{struct_image4_d_cuda_array_abdb9e7f88b589af46a4cf0b543ecac9b}{imgh},1);
385         p.kind = cudaMemcpyHostToDevice;
386         p.srcPtr = make\_cudaPitchedPtr(src, \textcolor{keyword}{sizeof}(T)*\hyperlink{struct_image4_d_cuda_array_a7f23302d874ffff216e49e33e9b5ca41}{imgw}, \textcolor{keyword}{sizeof}(T)*imgw, 
      \hyperlink{struct_image4_d_cuda_array_abdb9e7f88b589af46a4cf0b543ecac9b}{imgh});
387         \textcolor{keywordflow}{if} (async)
388             \hyperlink{gpu__utils_8h_ae6b059a7637782d61577e695c9d6303e}{CheckCUDAError}( cudaMemcpy3DAsync(&p, s) );
389         \textcolor{keywordflow}{else}
390             \hyperlink{gpu__utils_8h_ae6b059a7637782d61577e695c9d6303e}{CheckCUDAError}( cudaMemcpy3D(&p) );
391     \}
\end{DoxyCode}
\index{Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}!copy\+Image\+To\+Host@{copy\+Image\+To\+Host}}
\index{copy\+Image\+To\+Host@{copy\+Image\+To\+Host}!Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}}
\subsubsection[{\texorpdfstring{copy\+Image\+To\+Host(int img, int layer, T $\ast$dst, bool async=false, cuda\+Stream\+\_\+t s=0)}{copyImageToHost(int img, int layer, T *dst, bool async=false, cudaStream_t s=0)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ void {\bf Image4\+D\+Cuda\+Array}$<$ T $>$\+::copy\+Image\+To\+Host (
\begin{DoxyParamCaption}
\item[{int}]{img, }
\item[{int}]{layer, }
\item[{T $\ast$}]{dst, }
\item[{bool}]{async = {\ttfamily false}, }
\item[{cuda\+Stream\+\_\+t}]{s = {\ttfamily 0}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{struct_image4_d_cuda_array_ae5163e1758111d003633823d9af387f8}{}\label{struct_image4_d_cuda_array_ae5163e1758111d003633823d9af387f8}

\begin{DoxyCode}
349     \{
350         \textcolor{comment}{// According to CUDA docs:}
351         \textcolor{comment}{//      The extent field defines the dimensions of the transferred area in elements. }
352         \textcolor{comment}{//      If a CUDA array is participating in the copy, the extent is defined in terms of that
       array's elements. }
353         \textcolor{comment}{//      If no CUDA array is participating in the copy then the extents are defined in elements of
       unsigned char.}
354 
355         cudaMemcpy3DParms p = \{0\};
356         p.srcArray = \hyperlink{struct_image4_d_cuda_array_a4043697cb965dc8bd3dbc33f3840dd92}{array};
357         p.extent = make\_cudaExtent(\hyperlink{struct_image4_d_cuda_array_a7f23302d874ffff216e49e33e9b5ca41}{imgw},\hyperlink{struct_image4_d_cuda_array_abdb9e7f88b589af46a4cf0b543ecac9b}{imgh},1);
358         p.kind = cudaMemcpyDeviceToHost;
359         p.srcPos.z = layer;
360         int2 imgpos = \hyperlink{struct_image4_d_cuda_array_a24b592522dd8418266cfb434cc09f40e}{getImagePos}(img);
361         p.srcPos.x = imgpos.x;
362         p.srcPos.y = imgpos.y;
363         p.dstPtr = make\_cudaPitchedPtr(dst, \textcolor{keyword}{sizeof}(T)*\hyperlink{struct_image4_d_cuda_array_a7f23302d874ffff216e49e33e9b5ca41}{imgw}, \textcolor{keyword}{sizeof}(T)*imgw, 
      \hyperlink{struct_image4_d_cuda_array_abdb9e7f88b589af46a4cf0b543ecac9b}{imgh});
364         \textcolor{keywordflow}{if} (async)
365             \hyperlink{gpu__utils_8h_ae6b059a7637782d61577e695c9d6303e}{CheckCUDAError}( cudaMemcpy3DAsync(&p, s) );
366         \textcolor{keywordflow}{else}
367             \hyperlink{gpu__utils_8h_ae6b059a7637782d61577e695c9d6303e}{CheckCUDAError}( cudaMemcpy3D(&p) );
368     \}
\end{DoxyCode}
\index{Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}!copy\+To\+Device@{copy\+To\+Device}}
\index{copy\+To\+Device@{copy\+To\+Device}!Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}}
\subsubsection[{\texorpdfstring{copy\+To\+Device(\+T $\ast$src, bool async=false, cuda\+Stream\+\_\+t s=0)}{copyToDevice(T *src, bool async=false, cudaStream_t s=0)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ void {\bf Image4\+D\+Cuda\+Array}$<$ T $>$\+::copy\+To\+Device (
\begin{DoxyParamCaption}
\item[{T $\ast$}]{src, }
\item[{bool}]{async = {\ttfamily false}, }
\item[{cuda\+Stream\+\_\+t}]{s = {\ttfamily 0}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{struct_image4_d_cuda_array_a3cff003804ea5cdcc1fad578726a004b}{}\label{struct_image4_d_cuda_array_a3cff003804ea5cdcc1fad578726a004b}

\begin{DoxyCode}
308     \{
309         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} L=0;L<\hyperlink{struct_image4_d_cuda_array_a2cc68c6d8492e7a0d2fa194cc3a58187}{nlayers};L++) \{
310             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<\hyperlink{struct_image4_d_cuda_array_acc1ba710635bc84af3d3032b7a38dea3}{numImg};i++)
311                 \hyperlink{struct_image4_d_cuda_array_aed4f5c8cc5bda9d267b99757cbb23f80}{copyImageToDevice}(i, L, &src[ \hyperlink{struct_image4_d_cuda_array_a7f23302d874ffff216e49e33e9b5ca41}{imgw} * \hyperlink{struct_image4_d_cuda_array_abdb9e7f88b589af46a4cf0b543ecac9b}{imgh} * ( numImg * L + i ) ], 
      async, s);
312         \}
313     \}
\end{DoxyCode}
\index{Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}!copy\+To\+Host@{copy\+To\+Host}}
\index{copy\+To\+Host@{copy\+To\+Host}!Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}}
\subsubsection[{\texorpdfstring{copy\+To\+Host(\+T $\ast$dst, bool async=false, cuda\+Stream\+\_\+t s=0)}{copyToHost(T *dst, bool async=false, cudaStream_t s=0)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ void {\bf Image4\+D\+Cuda\+Array}$<$ T $>$\+::copy\+To\+Host (
\begin{DoxyParamCaption}
\item[{T $\ast$}]{dst, }
\item[{bool}]{async = {\ttfamily false}, }
\item[{cuda\+Stream\+\_\+t}]{s = {\ttfamily 0}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{struct_image4_d_cuda_array_a5f91354c4b6bffdfaea64d2feb078f81}{}\label{struct_image4_d_cuda_array_a5f91354c4b6bffdfaea64d2feb078f81}

\begin{DoxyCode}
316     \{
317         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} L=0;L<\hyperlink{struct_image4_d_cuda_array_a2cc68c6d8492e7a0d2fa194cc3a58187}{nlayers};L++) \{
318             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<\hyperlink{struct_image4_d_cuda_array_acc1ba710635bc84af3d3032b7a38dea3}{numImg};i++)
319                 \hyperlink{struct_image4_d_cuda_array_ae5163e1758111d003633823d9af387f8}{copyImageToHost}(i, L, &dst[ \hyperlink{struct_image4_d_cuda_array_a7f23302d874ffff216e49e33e9b5ca41}{imgw} * \hyperlink{struct_image4_d_cuda_array_abdb9e7f88b589af46a4cf0b543ecac9b}{imgh} * ( numImg * L + i ) ], 
      async, s);
320         \}
321     \}
\end{DoxyCode}
\index{Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}!free@{free}}
\index{free@{free}!Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}}
\subsubsection[{\texorpdfstring{free()}{free()}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ void {\bf Image4\+D\+Cuda\+Array}$<$ T $>$\+::free (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{struct_image4_d_cuda_array_a57f7d708e0ecbbfd96be7ebce94200e0}{}\label{struct_image4_d_cuda_array_a57f7d708e0ecbbfd96be7ebce94200e0}

\begin{DoxyCode}
393                 \{
394         \textcolor{keywordflow}{if} (\hyperlink{struct_image4_d_cuda_array_a4043697cb965dc8bd3dbc33f3840dd92}{array}) \{
395             \hyperlink{gpu__utils_8h_ae6b059a7637782d61577e695c9d6303e}{CheckCUDAError}( cudaFreeArray(\hyperlink{struct_image4_d_cuda_array_a4043697cb965dc8bd3dbc33f3840dd92}{array}) );
396             \hyperlink{struct_image4_d_cuda_array_a4043697cb965dc8bd3dbc33f3840dd92}{array} = 0;
397         \}
398     \}
\end{DoxyCode}
\index{Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}!get\+Extent@{get\+Extent}}
\index{get\+Extent@{get\+Extent}!Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}}
\subsubsection[{\texorpdfstring{get\+Extent()}{getExtent()}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ cuda\+Extent {\bf Image4\+D\+Cuda\+Array}$<$ T $>$\+::get\+Extent (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{struct_image4_d_cuda_array_a69a6e1459f05922d781b583e29fe07ca}{}\label{struct_image4_d_cuda_array_a69a6e1459f05922d781b583e29fe07ca}

\begin{DoxyCode}
222                            \{
223         \textcolor{keywordflow}{return} make\_cudaExtent(\hyperlink{struct_image4_d_cuda_array_a7f23302d874ffff216e49e33e9b5ca41}{imgw} * \hyperlink{struct_image4_d_cuda_array_aef314c7da09f67d8095bfb93a5102906}{layerw}, \hyperlink{struct_image4_d_cuda_array_abdb9e7f88b589af46a4cf0b543ecac9b}{imgh} * \hyperlink{struct_image4_d_cuda_array_a1fd2bc8556d6c750f67799dacad099a4}{layerh}, 
      \hyperlink{struct_image4_d_cuda_array_a2cc68c6d8492e7a0d2fa194cc3a58187}{nlayers});
224     \}
\end{DoxyCode}
\index{Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}!get\+Image\+Pos@{get\+Image\+Pos}}
\index{get\+Image\+Pos@{get\+Image\+Pos}!Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}}
\subsubsection[{\texorpdfstring{get\+Image\+Pos(int image)}{getImagePos(int image)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ int2 {\bf Image4\+D\+Cuda\+Array}$<$ T $>$\+::get\+Image\+Pos (
\begin{DoxyParamCaption}
\item[{int}]{image}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{struct_image4_d_cuda_array_a24b592522dd8418266cfb434cc09f40e}{}\label{struct_image4_d_cuda_array_a24b592522dd8418266cfb434cc09f40e}

\begin{DoxyCode}
298                                 \{
299         int2 pos = \{ \hyperlink{struct_image4_d_cuda_array_a7f23302d874ffff216e49e33e9b5ca41}{imgw} * ( image % \hyperlink{struct_image4_d_cuda_array_aef314c7da09f67d8095bfb93a5102906}{layerw} ), \hyperlink{struct_image4_d_cuda_array_abdb9e7f88b589af46a4cf0b543ecac9b}{imgh} * ( image / 
      \hyperlink{struct_image4_d_cuda_array_aef314c7da09f67d8095bfb93a5102906}{layerw} ) \};
300         \textcolor{keywordflow}{return} pos;
301     \}
\end{DoxyCode}
\index{Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}!kernel\+Inst@{kernel\+Inst}}
\index{kernel\+Inst@{kernel\+Inst}!Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}}
\subsubsection[{\texorpdfstring{kernel\+Inst()}{kernelInst()}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ {\bf Kernel\+Inst} {\bf Image4\+D\+Cuda\+Array}$<$ T $>$\+::kernel\+Inst (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{struct_image4_d_cuda_array_ab815a1a7c5a56396a1582845096d5ba4}{}\label{struct_image4_d_cuda_array_ab815a1a7c5a56396a1582845096d5ba4}

\begin{DoxyCode}
249                             \{
250         KernelInst inst;
251         inst.imgw = \hyperlink{struct_image4_d_cuda_array_a7f23302d874ffff216e49e33e9b5ca41}{imgw}; inst.imgh = \hyperlink{struct_image4_d_cuda_array_abdb9e7f88b589af46a4cf0b543ecac9b}{imgh};
252         inst.layerw = \hyperlink{struct_image4_d_cuda_array_aef314c7da09f67d8095bfb93a5102906}{layerw};
253         \textcolor{keywordflow}{return} inst;
254     \}
\end{DoxyCode}
\index{Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}!unbind@{unbind}}
\index{unbind@{unbind}!Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}}
\subsubsection[{\texorpdfstring{unbind(texture$<$ T, cuda\+Texture\+Type2\+D\+Layered, cuda\+Read\+Mode\+Element\+Type $>$ \&texref)}{unbind(texture< T, cudaTextureType2DLayered, cudaReadModeElementType > &texref)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ void {\bf Image4\+D\+Cuda\+Array}$<$ T $>$\+::unbind (
\begin{DoxyParamCaption}
\item[{texture$<$ T, cuda\+Texture\+Type2\+D\+Layered, cuda\+Read\+Mode\+Element\+Type $>$ \&}]{texref}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{struct_image4_d_cuda_array_a48bf8bb27196030387c6047cb6b7c323}{}\label{struct_image4_d_cuda_array_a48bf8bb27196030387c6047cb6b7c323}

\begin{DoxyCode}
260                                                                                        \{
261         cudaUnbindTexture(texref);
262     \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\index{Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}!array@{array}}
\index{array@{array}!Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}}
\subsubsection[{\texorpdfstring{array}{array}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ cuda\+Array\+\_\+t {\bf Image4\+D\+Cuda\+Array}$<$ T $>$\+::array}\hypertarget{struct_image4_d_cuda_array_a4043697cb965dc8bd3dbc33f3840dd92}{}\label{struct_image4_d_cuda_array_a4043697cb965dc8bd3dbc33f3840dd92}
\index{Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}!imgh@{imgh}}
\index{imgh@{imgh}!Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}}
\subsubsection[{\texorpdfstring{imgh}{imgh}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ int {\bf Image4\+D\+Cuda\+Array}$<$ T $>$\+::imgh}\hypertarget{struct_image4_d_cuda_array_abdb9e7f88b589af46a4cf0b543ecac9b}{}\label{struct_image4_d_cuda_array_abdb9e7f88b589af46a4cf0b543ecac9b}
\index{Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}!imgw@{imgw}}
\index{imgw@{imgw}!Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}}
\subsubsection[{\texorpdfstring{imgw}{imgw}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ int {\bf Image4\+D\+Cuda\+Array}$<$ T $>$\+::imgw}\hypertarget{struct_image4_d_cuda_array_a7f23302d874ffff216e49e33e9b5ca41}{}\label{struct_image4_d_cuda_array_a7f23302d874ffff216e49e33e9b5ca41}
\index{Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}!layerh@{layerh}}
\index{layerh@{layerh}!Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}}
\subsubsection[{\texorpdfstring{layerh}{layerh}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ int {\bf Image4\+D\+Cuda\+Array}$<$ T $>$\+::layerh}\hypertarget{struct_image4_d_cuda_array_a1fd2bc8556d6c750f67799dacad099a4}{}\label{struct_image4_d_cuda_array_a1fd2bc8556d6c750f67799dacad099a4}
\index{Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}!layerw@{layerw}}
\index{layerw@{layerw}!Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}}
\subsubsection[{\texorpdfstring{layerw}{layerw}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ int {\bf Image4\+D\+Cuda\+Array}$<$ T $>$\+::layerw}\hypertarget{struct_image4_d_cuda_array_aef314c7da09f67d8095bfb93a5102906}{}\label{struct_image4_d_cuda_array_aef314c7da09f67d8095bfb93a5102906}
\index{Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}!nlayers@{nlayers}}
\index{nlayers@{nlayers}!Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}}
\subsubsection[{\texorpdfstring{nlayers}{nlayers}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ int {\bf Image4\+D\+Cuda\+Array}$<$ T $>$\+::nlayers}\hypertarget{struct_image4_d_cuda_array_a2cc68c6d8492e7a0d2fa194cc3a58187}{}\label{struct_image4_d_cuda_array_a2cc68c6d8492e7a0d2fa194cc3a58187}
\index{Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}!num\+Img@{num\+Img}}
\index{num\+Img@{num\+Img}!Image4\+D\+Cuda\+Array@{Image4\+D\+Cuda\+Array}}
\subsubsection[{\texorpdfstring{num\+Img}{numImg}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ int {\bf Image4\+D\+Cuda\+Array}$<$ T $>$\+::num\+Img}\hypertarget{struct_image4_d_cuda_array_acc1ba710635bc84af3d3032b7a38dea3}{}\label{struct_image4_d_cuda_array_acc1ba710635bc84af3d3032b7a38dea3}


The documentation for this struct was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
cudatrack/\hyperlink{cuda_image_list_8h}{cuda\+Image\+List.\+h}\end{DoxyCompactItemize}
